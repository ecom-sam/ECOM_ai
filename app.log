[INFO] Scanning for projects...
[INFO] 
[INFO] -------------------< com.ecom.ai:ecom-assistant-api >-------------------
[INFO] Building ecom-assistant-api 0.0.1-SNAPSHOT
[INFO]   from pom.xml
[INFO] --------------------------------[ jar ]---------------------------------
[INFO] 
[INFO] >>> spring-boot:3.4.5:run (default-cli) > test-compile @ ecom-assistant-api >>>
[INFO] 
[INFO] --- resources:3.3.1:resources (default-resources) @ ecom-assistant-api ---
[INFO] Copying 1 resource from src/main/resources to target/classes
[INFO] Copying 1 resource from src/main/resources to target/classes
[INFO] 
[INFO] --- compiler:3.13.0:compile (default-compile) @ ecom-assistant-api ---
[INFO] Nothing to compile - all classes are up to date.
[INFO] 
[INFO] --- resources:3.3.1:testResources (default-testResources) @ ecom-assistant-api ---
[INFO] skip non existing resourceDirectory /mnt/e/work/Couchbase/ecom_ai/ecom-assistant/ecom-assistant-api/src/test/resources
[INFO] 
[INFO] --- compiler:3.13.0:testCompile (default-testCompile) @ ecom-assistant-api ---
[INFO] No sources to compile
[INFO] 
[INFO] <<< spring-boot:3.4.5:run (default-cli) < test-compile @ ecom-assistant-api <<<
[INFO] 
[INFO] 
[INFO] --- spring-boot:3.4.5:run (default-cli) @ ecom-assistant-api ---
[INFO] Attaching agents: []

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/

 :: Spring Boot ::                (v3.4.5)

2025-07-29T18:11:26.932+08:00  INFO 21129 --- [ecom-assistant] [           main] c.e.a.e.EcomAssistantApplication         : Starting EcomAssistantApplication using Java 21.0.8 with PID 21129 (/mnt/e/work/Couchbase/ecom_ai/ecom-assistant/ecom-assistant-api/target/classes started by sam in /mnt/e/work/Couchbase/ecom_ai/ecom-assistant/ecom-assistant-api)
2025-07-29T18:11:26.935+08:00  INFO 21129 --- [ecom-assistant] [           main] c.e.a.e.EcomAssistantApplication         : No active profile set, falling back to 1 default profile: "default"
2025-07-29T18:11:30.722+08:00  INFO 21129 --- [ecom-assistant] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Couchbase repositories in DEFAULT mode.
2025-07-29T18:11:30.759+08:00  INFO 21129 --- [ecom-assistant] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 21 ms. Found 0 Couchbase repository interfaces.
2025-07-29T18:11:32.025+08:00  INFO 21129 --- [ecom-assistant] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Couchbase repositories in DEFAULT mode.
2025-07-29T18:11:33.185+08:00  INFO 21129 --- [ecom-assistant] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 1157 ms. Found 0 Couchbase repository interfaces.
2025-07-29T18:11:33.190+08:00  INFO 21129 --- [ecom-assistant] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data Couchbase repositories in DEFAULT mode.
2025-07-29T18:11:33.677+08:00  INFO 21129 --- [ecom-assistant] [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 484 ms. Found 11 Couchbase repository interfaces.
2025-07-29T18:11:34.213+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'shiroConfig' of type [com.ecom.ai.ecomassistant.auth.config.ShiroConfig$$SpringCGLIB$$0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). The currently created BeanPostProcessor [lifecycleBeanPostProcessor] is declared through a non-static factory method on that class; consider declaring it as static instead.
2025-07-29T18:11:34.407+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'couchbaseConfig' of type [com.ecom.ai.ecomassistant.db.config.CouchbaseConfig$$SpringCGLIB$$0] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:35.831+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'couchbaseClusterEnvironment' of type [com.couchbase.client.java.env.ClusterEnvironment] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:35.834+08:00  INFO 21129 --- [ecom-assistant] [           main] c.e.a.e.db.config.CouchbaseConfig        : Connecting to Couchbase cluster at 127.0.0.1
2025-07-29T18:11:36.331+08:00  INFO 21129 --- [ecom-assistant] [oundedElastic-1] c.c.c.c.c.DefaultConfigurationProvider   : Resolved seed nodes: [SeedNode{address='127.0.0.1'}]
2025-07-29T18:11:37.218+08:00  INFO 21129 --- [ecom-assistant] [   cb-io-kv-9-1] c.c.c.c.compression.snappy.SnappyHelper  : Using fast Snappy compression codec because this is little-endian hardware and `sun.misc.Unsafe` is accessible.
2025-07-29T18:11:37.260+08:00  INFO 21129 --- [ecom-assistant] [      cb-events] com.couchbase.core                       : [com.couchbase.core][CoreCreatedEvent] {"clientVersion":"3.7.9","clientGitHash":"b5ce2184","coreVersion":"3.7.9","coreGitHash":"b5ce2184","userAgent":"couchbase-java/3.7.9 (Linux 6.6.87.2-microsoft-standard-WSL2 amd64; OpenJDK 64-Bit Server VM 21.0.8+9-Ubuntu-0ubuntu124.04.1)","maxNumRequestsInRetry":32768,"ioEnvironment":{"nativeIoEnabled":true,"eventLoopThreadCount":8,"eventLoopGroups":["EpollEventLoopGroup"]},"ioConfig":{"captureTraffic":[],"mutationTokensEnabled":true,"networkResolution":"auto","dnsSrvEnabled":true,"tcpKeepAlivesEnabled":true,"tcpKeepAliveTimeMs":60000,"configPollIntervalMs":2500,"kvCircuitBreakerConfig":"disabled","queryCircuitBreakerConfig":"disabled","viewCircuitBreakerConfig":"disabled","searchCircuitBreakerConfig":"disabled","analyticsCircuitBreakerConfig":"disabled","managerCircuitBreakerConfig":"disabled","eventingCircuitBreakerConfig":"disabled","backupCircuitBreakerConfig":"disabled","numKvConnections":1,"maxHttpConnections":12,"idleHttpConnectionTimeoutMs":1000,"configIdleRedialTimeoutMs":300000,"memcachedHashingStrategy":"StandardMemcachedHashingStrategy","timerConfig":{"numTimers":1,"tickDurationMs":10,"numBuckets":512},"lowWaterMark":"32 KiB","highWaterMark":"64 KiB","sendBuffer":null,"receiveBuffer":null},"compressionConfig":{"enabled":true,"minRatio":0.83,"minSize":32},"securityConfig":{"tlsEnabled":false,"nativeTlsEnabled":true,"hostnameVerificationEnabled":true,"trustCertificates":null,"trustManagerFactory":null,"ciphers":[]},"timeoutConfig":{"kvMs":2500,"kvDurableMs":10000,"kvScanMs":75000,"managementMs":75000,"queryMs":75000,"viewMs":75000,"searchMs":75000,"analyticsMs":75000,"connectMs":10000,"disconnectMs":10000,"eventingMs":75000,"backupMs":75000},"loggerConfig":{"diagnosticContextEnabled":false},"orphanReporterConfig":{"emitIntervalMs":10000,"sampleSize":10,"queueLength":1024,"enabled":true},"thresholdLoggingTracerConfig":{"enabled":true,"emitIntervalMs":10000,"sampleSize":10,"queueLength":1024,"kvThresholdMs":500,"queryThresholdMs":1000,"searchThresholdMs":1000,"analyticsThresholdMs":1000,"viewThresholdMs":1000,"transactionsThresholdMs":5000},"loggingMeterConfig":{"enabled":true,"emitIntervalMs":600000},"retryStrategy":"BestEffortRetryStrategy","requestTracer":"ThresholdLoggingTracer","meter":"LoggingMeter","numRequestCallbacks":0,"scheduler":"ParallelScheduler","schedulerThreadCount":16,"transactionsConfig":{"durabilityLevel":"MAJORITY","timeoutMs":15000,"cleanupConfig":{"runLostAttemptsCleanupThread":true,"runRegularAttemptsCleanupThread":true,"cleanupWindowMs":60000,"cleanupSet":""},"numAtrs":1024,"metadataCollection":"none","scanConsistency":"none"},"preferredServerGroup":"null"} {"connectionString":"couchbase://127.0.0.1","coreId":"0x7225d20200000001","numCoreInstances":1}
2025-07-29T18:11:37.260+08:00  INFO 21129 --- [ecom-assistant] [      cb-events] com.couchbase.transactions               : [com.couchbase.transactions][TransactionsStartedEvent] Transactions successfully initialised, regular cleanup enabled=true, lost cleanup enabled=true
2025-07-29T18:11:37.260+08:00  INFO 21129 --- [ecom-assistant] [      cb-events] com.couchbase.node                       : [com.couchbase.node][NodeCreatedEvent] Node created {"coreId":"0x7225d20200000001","managerPort":"8091","remote":"127.0.0.1"}
2025-07-29T18:11:38.588+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'couchbaseCluster' of type [com.couchbase.client.java.Cluster] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:38.643+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'couchbaseClientFactory' of type [org.springframework.data.couchbase.SimpleCouchbaseClientFactory] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:38.761+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'couchbaseCustomConversions' of type [org.springframework.data.couchbase.core.convert.CouchbaseCustomConversions] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:38.776+08:00  INFO 21129 --- [ecom-assistant] [      cb-events] com.couchbase.core                       : [com.couchbase.core][BucketOpenedEvent][121ms] Opened bucket "ECOM" {"coreId":"0x7225d20200000001"}
2025-07-29T18:11:38.807+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'couchbaseMappingContext' of type [org.springframework.data.couchbase.core.mapping.CouchbaseMappingContext] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:38.853+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean '(inner bean)#146f3d22' of type [org.springframework.beans.factory.config.ObjectFactoryCreatingFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:38.854+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean '(inner bean)#146f3d22' of type [org.springframework.beans.factory.config.ObjectFactoryCreatingFactoryBean$TargetBeanObjectFactory] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:38.867+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'mappingCouchbaseConverter' of type [org.springframework.data.couchbase.core.convert.MappingCouchbaseConverter] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:38.922+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'couchbaseTranslationService' of type [org.springframework.data.couchbase.core.convert.translation.JacksonTranslationService] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.091+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'couchbaseTemplate' of type [org.springframework.data.couchbase.core.CouchbaseTemplate] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.092+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'couchbaseRepositoryOperationsMapping' of type [org.springframework.data.couchbase.repository.config.RepositoryOperationsMapping] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.101+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'couchbase.named-queries#3' of type [org.springframework.data.repository.config.PropertiesBasedNamedQueriesFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.101+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'couchbase.named-queries#3' of type [org.springframework.data.repository.core.support.PropertiesBasedNamedQueries] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.526+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'userRepository' of type [org.springframework.data.couchbase.repository.support.CouchbaseRepositoryFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.527+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'userRepository' of type [jdk.proxy2.$Proxy104] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.528+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'userService' of type [com.ecom.ai.ecomassistant.db.service.auth.UserService] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.580+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'couchbase.named-queries#2' of type [org.springframework.data.repository.config.PropertiesBasedNamedQueriesFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.581+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'couchbase.named-queries#2' of type [org.springframework.data.repository.core.support.PropertiesBasedNamedQueries] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.586+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'teamRepository' of type [org.springframework.data.couchbase.repository.support.CouchbaseRepositoryFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.587+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'teamRepository' of type [jdk.proxy2.$Proxy106] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.587+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'teamService' of type [com.ecom.ai.ecomassistant.db.service.auth.TeamService] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.590+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'couchbase.named-queries#1' of type [org.springframework.data.repository.config.PropertiesBasedNamedQueriesFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.590+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'couchbase.named-queries#1' of type [org.springframework.data.repository.core.support.PropertiesBasedNamedQueries] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.608+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'teamMembershipRepository' of type [org.springframework.data.couchbase.repository.support.CouchbaseRepositoryFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.608+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'teamMembershipRepository' of type [jdk.proxy2.$Proxy107] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.609+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'teamMembershipService' of type [com.ecom.ai.ecomassistant.db.service.auth.TeamMembershipService] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.611+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'couchbase.named-queries#7' of type [org.springframework.data.repository.config.PropertiesBasedNamedQueriesFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.612+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'couchbase.named-queries#7' of type [org.springframework.data.repository.core.support.PropertiesBasedNamedQueries] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.623+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'teamRoleRepository' of type [org.springframework.data.couchbase.repository.support.CouchbaseRepositoryFactoryBean] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.623+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'teamRoleRepository' of type [jdk.proxy2.$Proxy108] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.624+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'teamRoleService' of type [com.ecom.ai.ecomassistant.db.service.auth.TeamRoleService] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.629+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'userManager' of type [com.ecom.ai.ecomassistant.core.service.UserManager] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.639+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'couchbaseRealm' of type [com.ecom.ai.ecomassistant.auth.realm.CouchbaseRealm] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.752+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'securityManager' of type [org.apache.shiro.web.mgt.DefaultWebSecurityManager] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.755+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'shiroFilterChainDefinition' of type [org.apache.shiro.spring.web.config.DefaultShiroFilterChainDefinition] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor [methodValidationPostProcessor]? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:39.948+08:00  WARN 21129 --- [ecom-assistant] [           main] trationDelegate$BeanPostProcessorChecker : Bean 'authorizationAttributeSourceAdvisor' of type [org.apache.shiro.spring.security.interceptor.AuthorizationAttributeSourceAdvisor] is not eligible for getting processed by all BeanPostProcessors (for example: not eligible for auto-proxying). Is this bean getting eagerly injected/applied to a currently created BeanPostProcessor []? Check the corresponding BeanPostProcessor declaration and its dependencies/advisors. If this bean does not have to be post-processed, declare it with ROLE_INFRASTRUCTURE.
2025-07-29T18:11:41.538+08:00  INFO 21129 --- [ecom-assistant] [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port 8080 (http)
2025-07-29T18:11:41.573+08:00  INFO 21129 --- [ecom-assistant] [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2025-07-29T18:11:41.574+08:00  INFO 21129 --- [ecom-assistant] [           main] o.apache.catalina.core.StandardEngine    : Starting Servlet engine: [Apache Tomcat/10.1.40]
2025-07-29T18:11:41.713+08:00  INFO 21129 --- [ecom-assistant] [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2025-07-29T18:11:41.714+08:00  INFO 21129 --- [ecom-assistant] [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 14670 ms
2025-07-29T18:11:43.904+08:00  INFO 21129 --- [ecom-assistant] [           main] o.s.a.v.CouchbaseSearchVectorStore       : Init Cluster Called
2025-07-29T18:11:44.034+08:00  INFO 21129 --- [ecom-assistant] [           main] o.s.a.v.CouchbaseSearchVectorStore       : Created bucket
2025-07-29T18:11:44.087+08:00  INFO 21129 --- [ecom-assistant] [           main] o.s.a.v.CouchbaseSearchVectorStore       : Opened Bucket
2025-07-29T18:11:44.136+08:00  INFO 21129 --- [ecom-assistant] [           main] c.c.client.core.util.ConsistencyUtil     : Waiting for config
2025-07-29T18:11:44.136+08:00  INFO 21129 --- [ecom-assistant] [           main] c.c.client.core.util.ConsistencyUtil     : Adding nodes from global config: [NodeIdentifier{canonical=127.0.0.1:8091, hostForNetworkConnections='127.0.0.1'}]
2025-07-29T18:11:44.137+08:00  INFO 21129 --- [ecom-assistant] [           main] c.c.client.core.util.ConsistencyUtil     : Adding nodes from bucket configs: [NodeIdentifier{canonical=127.0.0.1:8091, hostForNetworkConnections='127.0.0.1'}]
QA VectorStore configured:
  - Bucket: ECOM
  - Scope: AI
  - Collection: qa-vector
  - Expected Index: spring-ai-qa-vector-index
2025-07-29T18:11:44.443+08:00  INFO 21129 --- [ecom-assistant] [           main] c.e.a.e.ai.service.TieredRAGService      : 🔧 Tiered RAG Configuration:
2025-07-29T18:11:44.444+08:00  INFO 21129 --- [ecom-assistant] [           main] c.e.a.e.ai.service.TieredRAGService      :   - Enabled: true
2025-07-29T18:11:44.444+08:00  INFO 21129 --- [ecom-assistant] [           main] c.e.a.e.ai.service.TieredRAGService      :   - Priority: QA_FIRST
2025-07-29T18:11:44.445+08:00  INFO 21129 --- [ecom-assistant] [           main] c.e.a.e.ai.service.TieredRAGService      :   - QA Vector: enabled=true, topK=3, strategy=DIRECT_FTS_FIRST
2025-07-29T18:11:44.445+08:00  INFO 21129 --- [ecom-assistant] [           main] c.e.a.e.ai.service.TieredRAGService      :   - Document Vector: enabled=true, topK=6, threshold=0.7
2025-07-29T18:11:44.445+08:00  INFO 21129 --- [ecom-assistant] [           main] c.e.a.e.ai.service.TieredRAGService      :   - Max Results: 8, Fallback: true
2025-07-29T18:11:45.341+08:00  INFO 21129 --- [ecom-assistant] [           main] o.s.d.c.c.m.event.AuditingEventListener  : auditingHandler IS an IsNewAwareAuditingHandler: org.springframework.data.auditing.IsNewAwareAuditingHandler@effa124
2025-07-29T18:11:46.986+08:00  INFO 21129 --- [ecom-assistant] [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port 8080 (http) with context path '/'
2025-07-29T18:11:46.992+08:00  INFO 21129 --- [ecom-assistant] [           main] c.e.a.e.EcomAssistantApplication         : Started EcomAssistantApplication in 21.706 seconds (process running for 22.352)
2025-07-29T18:12:08.802+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2025-07-29T18:12:08.802+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2025-07-29T18:12:08.804+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] o.s.web.servlet.DispatcherServlet        : Completed initialization in 2 ms
2025-07-29T18:12:09.071+08:00  WARN 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.auth.filter.JwtFilter            : JWT authentication failed: Invalid JWT token
2025-07-29T18:12:36.952+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=25c8b4ae-9124-4647-98a3-a922cd3cbe04 scope: AI collection: dataset options: com.couchbase.client.java.kv.GetOptions@21822d85
2025-07-29T18:12:37.194+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: document options: null statement: SELECT `_class`, META(`document`).`id` AS __id, `datasetId`, `fileName`, `fullPath`, `storageType`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `document` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.Document" AND `datasetId` = $1
2025-07-29T18:12:37.314+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["25c8b4ae-9124-4647-98a3-a922cd3cbe04"],"client_context_id":"a03eae5b-d2f2-4024-9099-fe59d6f7f052","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:37.711+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:37.712+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:37.713+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@67ff93b0
2025-07-29T18:12:37.713+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:37.713+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@c77d3a4
2025-07-29T18:12:37.714+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:37.715+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@101f65d5
2025-07-29T18:12:37.716+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@3c53cbd0
2025-07-29T18:12:37.716+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:37.717+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@7bd5f0a0
2025-07-29T18:12:37.762+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:37.762+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:37.762+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:37.762+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:37.762+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:37.762+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"8392a9b3-39ae-481a-bb99-bd4f30b79e90","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:37.762+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"379f98bb-6b91-45ef-930d-4b1c3a27a9f0","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:37.763+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"a71a0a07-733c-4f8b-a27a-d9414ca6c090","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:37.763+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"b49517f5-441c-49c0-bcc0-a3e7d47b48b5","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:37.763+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"b2e0a590-add4-422d-b1d9-4f00c2c154e2","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:37.782+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@6d07f8c0
2025-07-29T18:12:37.782+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@58aea4fb
2025-07-29T18:12:37.782+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@5fcb5e82
2025-07-29T18:12:37.782+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@1ae70ea5
2025-07-29T18:12:37.782+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@36aba0a0
2025-07-29T18:12:37.797+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@2dfc1fd5
2025-07-29T18:12:37.798+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5fe5939d
2025-07-29T18:12:37.798+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@73a92811
2025-07-29T18:12:37.799+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@28057b04
2025-07-29T18:12:37.799+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@6e27d487
2025-07-29T18:12:37.826+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@292bff1c
2025-07-29T18:12:37.826+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@343f7479
2025-07-29T18:12:37.827+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@518660ff
2025-07-29T18:12:37.827+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@337c0fa7
2025-07-29T18:12:37.828+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3632faef
2025-07-29T18:12:37.830+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@1d1c5a96
2025-07-29T18:12:37.830+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@6e70cef1
2025-07-29T18:12:37.830+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@42909d97
2025-07-29T18:12:37.831+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@1967317e
2025-07-29T18:12:37.831+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@10b965f2
2025-07-29T18:12:37.832+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@18a638f9
2025-07-29T18:12:37.833+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4c4077bc
2025-07-29T18:12:37.833+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@29558bc5
2025-07-29T18:12:37.834+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3d1d8262
2025-07-29T18:12:37.834+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4bf41b6a
2025-07-29T18:12:37.834+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:37.835+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:37.835+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:37.835+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:37.835+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:37.835+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:37.836+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:37.836+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:37.836+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:37.837+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:37.887+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:37.887+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:37.887+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:37.887+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:37.887+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:37.888+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["0b2ccf95-86ad-4d3a-a0d5-028963a7498d"],"client_context_id":"b7590451-71c7-47e4-869c-50c7a58c07b8","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:37.888+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8"],"client_context_id":"dd80abdc-3542-4c6d-8c73-1f56cd8ae5d1","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:37.888+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["22dd70f0-5f00-458c-acfd-7919d26f8ee0"],"client_context_id":"b57664be-1485-4699-81df-fd0546bdd7cc","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:37.888+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["a790aa4e-d9d7-4925-a97f-b811fcbf331b"],"client_context_id":"b5e2bc84-0f1c-4126-9c01-2785d132d474","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:37.888+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["2d250eb0-0c42-469a-8b29-628e13ab1820"],"client_context_id":"5e9c62f8-dd7c-47cf-a2c0-a5ed50c5183f","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:37.962+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : Failed to get QA stats for document 22dd70f0-5f00-458c-acfd-7919d26f8ee0: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52174","lastDispatchedTo":"127.0.0.1:8093","requestId":104,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1189,"totalDispatchMicros":1189,"totalMicros":32833}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52174","lastDispatchedTo":"127.0.0.1:8093","requestId":104,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1189,"totalDispatchMicros":1189,"totalMicros":32833}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:12:37.962+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : Failed to get QA stats for document a790aa4e-d9d7-4925-a97f-b811fcbf331b: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52210","lastDispatchedTo":"127.0.0.1:8093","requestId":105,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1057,"totalDispatchMicros":1057,"totalMicros":32380}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52210","lastDispatchedTo":"127.0.0.1:8093","requestId":105,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1057,"totalDispatchMicros":1057,"totalMicros":32380}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:12:37.962+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : Failed to get QA stats for document b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52194","lastDispatchedTo":"127.0.0.1:8093","requestId":103,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1661,"totalDispatchMicros":1661,"totalMicros":33280}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52194","lastDispatchedTo":"127.0.0.1:8093","requestId":103,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1661,"totalDispatchMicros":1661,"totalMicros":33280}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:12:37.962+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : Failed to get QA stats for document 2d250eb0-0c42-469a-8b29-628e13ab1820: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52168","lastDispatchedTo":"127.0.0.1:8093","requestId":106,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1420,"totalDispatchMicros":1420,"totalMicros":32092}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52168","lastDispatchedTo":"127.0.0.1:8093","requestId":106,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1420,"totalDispatchMicros":1420,"totalMicros":32092}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:12:37.962+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : Failed to get QA stats for document 0b2ccf95-86ad-4d3a-a0d5-028963a7498d: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52188","lastDispatchedTo":"127.0.0.1:8093","requestId":102,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1354,"totalDispatchMicros":1354,"totalMicros":33507}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52188","lastDispatchedTo":"127.0.0.1:8093","requestId":102,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1354,"totalDispatchMicros":1354,"totalMicros":33507}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:12:39.757+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:39.758+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"fc19951d-0515-4525-b1e9-20ec8d0c2a62","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:39.773+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team options: null statement: SELECT `_class`, META(`team`).`id` AS __id, `name`, `description`, `ownerId`, `active`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.Team" AND META().id IN $ids ORDER BY name ASC
2025-07-29T18:12:39.775+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] o.s.d.c.core.query.OptionsBuilder        : query options: {"client_context_id":"88d2e246-bca2-49b4-89f7-760d6aa2dee1","metrics":false,"$ids":["c79e8f7a-7d4d-47d7-982e-e87b69df5ab5"],"scan_consistency":"request_plus"}
2025-07-29T18:12:39.802+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@599ab90f
2025-07-29T18:12:39.807+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:39.808+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"7ebb11e6-d09f-40df-a2fb-940e90013a40","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:39.814+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@344af9de
2025-07-29T18:12:39.816+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4c60c665
2025-07-29T18:12:39.818+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@b20bfdb
2025-07-29T18:12:39.822+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@34510df6
2025-07-29T18:12:39.824+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@57b686ab
2025-07-29T18:12:39.827+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team options: null statement: SELECT `_class`, META(`team`).`id` AS __id, `name`, `description`, `ownerId`, `active`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.Team" ORDER BY name ASC
2025-07-29T18:12:39.828+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] o.s.d.c.core.query.OptionsBuilder        : query options: {"client_context_id":"464450e2-d574-4dab-89f3-7445d8dec06c","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:39.836+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement:         SELECT '' AS __id, tm.teamId AS teamId, COUNT(*) AS count
        FROM `team-membership` tm
        WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership"
        AND tm.teamId IN $teamIds
        GROUP BY tm.teamId

2025-07-29T18:12:39.837+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] o.s.d.c.core.query.OptionsBuilder        : query options: {"client_context_id":"79814446-e3c6-4897-8a80-7fd768f5e2cd","metrics":false,"$teamIds":["c79e8f7a-7d4d-47d7-982e-e87b69df5ab5","default_team"],"scan_consistency":"request_plus"}
2025-07-29T18:12:39.880+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:39.881+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"b55a3fb1-c4ce-46d0-9e6b-98cc58adeffb","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:39.887+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team options: null statement: SELECT `_class`, META(`team`).`id` AS __id, `name`, `description`, `ownerId`, `active`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.Team" AND META().id IN $ids ORDER BY name ASC
2025-07-29T18:12:39.888+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"client_context_id":"f3f80f0e-d853-4ca9-9544-3a257809506a","metrics":false,"$ids":["c79e8f7a-7d4d-47d7-982e-e87b69df5ab5"],"scan_consistency":"request_plus"}
2025-07-29T18:12:39.895+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@67aa62b8
2025-07-29T18:12:39.896+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:39.897+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"c628b992-d1f7-4938-bd5d-d790ff3bd8ad","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:39.903+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@7f1c09ce
2025-07-29T18:12:39.904+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@422d4ea
2025-07-29T18:12:39.906+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@6993d39c
2025-07-29T18:12:39.907+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5d18d3b4
2025-07-29T18:12:39.909+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4255e3a0
2025-07-29T18:12:39.911+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team options: null statement: SELECT `_class`, META(`team`).`id` AS __id, `name`, `description`, `ownerId`, `active`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.Team" ORDER BY name ASC
2025-07-29T18:12:39.912+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"client_context_id":"de77e99b-5ce3-484d-a603-71ac339f4aa7","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:39.918+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement:         SELECT '' AS __id, tm.teamId AS teamId, COUNT(*) AS count
        FROM `team-membership` tm
        WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership"
        AND tm.teamId IN $teamIds
        GROUP BY tm.teamId

2025-07-29T18:12:39.919+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"client_context_id":"c3a48000-13e9-4547-af07-651f2c198a2a","metrics":false,"$teamIds":["c79e8f7a-7d4d-47d7-982e-e87b69df5ab5","default_team"],"scan_consistency":"request_plus"}
2025-07-29T18:12:39.980+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@73e101e5
2025-07-29T18:12:39.982+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT '' as __id, tm.teamId AS teamId, tm.teamRoles AS teamRoles,
{
  "id": META(u).id,
  "name": u.name,
  "email": u.email,
  "status": u.status
} AS user
FROM `team-membership` tm
JOIN `user` u ON KEYS tm.userId
WHERE tm.teamId = $teamId

2025-07-29T18:12:39.982+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-role options: null statement:            SELECT META(r).id AS __id,
              r.name AS name,
              r.description AS description,
              r.permissions AS permissions,
              r.isSystemRole AS isSystemRole,
              COUNT(DISTINCT m.userId) AS userCount
       FROM `team-role` r
       LEFT JOIN `team-membership` m
         ON ARRAY_CONTAINS(m.teamRoles, META(r).id)
         AND m.teamId = $teamId
       WHERE r.isSystemRole = true
       GROUP BY
           META(r).id,
           r.name,
           r.description,
           r.permissions,
           r.isSystemRole

2025-07-29T18:12:39.983+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] o.s.d.c.core.query.OptionsBuilder        : query options: {"client_context_id":"8a33d4ed-9430-48f6-b02a-dff19a4ced6f","$teamId":"c79e8f7a-7d4d-47d7-982e-e87b69df5ab5","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:39.983+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] o.s.d.c.core.query.OptionsBuilder        : query options: {"client_context_id":"fefb7dd7-218f-4b3c-bbef-822a511ba4ed","$teamId":"c79e8f7a-7d4d-47d7-982e-e87b69df5ab5","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:39.984+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@480dd69d
2025-07-29T18:12:39.984+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=8e5a59f8-cef9-435d-9271-4ba92a70906e scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@2cb3834d
2025-07-29T18:12:40.192+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-role options: null statement: SELECT `_class`, META(`team-role`).`id` AS __id, `teamId`, `name`, `description`, `permissions`, `isSystemRole` FROM `team-role` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamRole" AND `teamId` = $1
2025-07-29T18:12:40.193+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["c79e8f7a-7d4d-47d7-982e-e87b69df5ab5"],"client_context_id":"f56a1a4a-e055-4f79-adf1-a686ef62293e","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:40.198+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-role options: null statement:            SELECT '' AS __id, META(r).id AS roleId, COUNT(DISTINCT m.userId) AS userCount
           FROM `team-role` r
           LEFT JOIN `team-membership` m
           ON r.teamId = m.teamId
           AND ARRAY_CONTAINS(m.teamRoles, META(r).id)
           WHERE META(r).id IN $1
           GROUP BY META(r).id

2025-07-29T18:12:40.199+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":[[]],"client_context_id":"8816c5b8-d3df-4ca3-8728-73e3f791686f","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:41.796+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@125441bc
2025-07-29T18:12:41.799+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:41.799+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"14089bae-b694-418d-89f0-3b444dfe290f","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:41.805+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@7fa12878
2025-07-29T18:12:41.807+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@13a7767e
2025-07-29T18:12:41.808+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@234e9c17
2025-07-29T18:12:41.809+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@154d15b1
2025-07-29T18:12:41.810+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@63d90d88
2025-07-29T18:12:41.812+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: dataset options: null statement: SELECT `_class`, META(`dataset`).`id` AS __id, `name`, `description`, `teamId`, `accessType`, `authorizedTeamIds`, `tags`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `dataset` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.Dataset" ORDER BY createdDateTime DESC,name ASC LIMIT 12
2025-07-29T18:12:41.813+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] o.s.d.c.core.query.OptionsBuilder        : query options: {"client_context_id":"359fcf78-f971-4257-bdfb-d93508c9444b","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:41.825+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: dataset options: null statement: SELECT COUNT("*") AS `count` FROM `dataset` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.Dataset"
2025-07-29T18:12:41.826+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] o.s.d.c.core.query.OptionsBuilder        : query options: {"client_context_id":"5bca331b-753d-4048-98c5-32f7e17c2884","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:41.859+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@50c2fa84
2025-07-29T18:12:41.861+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:41.862+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"02b761e1-3bc6-43de-861e-ba4637b2f6a9","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:41.867+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@27badc33
2025-07-29T18:12:41.869+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3c243e03
2025-07-29T18:12:41.870+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@510182c4
2025-07-29T18:12:41.871+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@16d054ba
2025-07-29T18:12:41.872+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@67fa4917
2025-07-29T18:12:41.874+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: dataset options: null statement: SELECT `_class`, META(`dataset`).`id` AS __id, `name`, `description`, `teamId`, `accessType`, `authorizedTeamIds`, `tags`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `dataset` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.Dataset" ORDER BY createdDateTime DESC,name ASC LIMIT 12
2025-07-29T18:12:41.874+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"client_context_id":"33a528b1-7fcd-438c-aa7a-1fb0e381aa76","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:41.880+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: dataset options: null statement: SELECT COUNT("*") AS `count` FROM `dataset` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.Dataset"
2025-07-29T18:12:41.880+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"client_context_id":"4d3a2b02-7dd3-49b9-95a0-c8c907412b8b","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:43.301+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=25c8b4ae-9124-4647-98a3-a922cd3cbe04 scope: AI collection: dataset options: com.couchbase.client.java.kv.GetOptions@79be76a
2025-07-29T18:12:43.303+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: document options: null statement: SELECT `_class`, META(`document`).`id` AS __id, `datasetId`, `fileName`, `fullPath`, `storageType`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `document` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.Document" AND `datasetId` = $1
2025-07-29T18:12:43.303+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["25c8b4ae-9124-4647-98a3-a922cd3cbe04"],"client_context_id":"0aba8d61-2ce1-439d-b60e-200644e81476","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:43.318+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=25c8b4ae-9124-4647-98a3-a922cd3cbe04 scope: AI collection: dataset options: com.couchbase.client.java.kv.GetOptions@694185f1
2025-07-29T18:12:43.321+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: document options: null statement: SELECT `_class`, META(`document`).`id` AS __id, `datasetId`, `fileName`, `fullPath`, `storageType`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `document` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.Document" AND `datasetId` = $1
2025-07-29T18:12:43.321+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["25c8b4ae-9124-4647-98a3-a922cd3cbe04"],"client_context_id":"97d52766-c977-4a86-ba91-5af0d87e87a4","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:43.327+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:43.327+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:43.327+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:43.327+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@1c979262
2025-07-29T18:12:43.328+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@45d387b4
2025-07-29T18:12:43.328+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@772470b9
2025-07-29T18:12:43.330+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:43.331+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:43.330+08:00  INFO 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:43.331+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:43.331+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:43.332+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@4590e8bb
2025-07-29T18:12:43.331+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"d4271d69-e08a-42ab-96c8-b9facdd1ced3","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:43.331+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@17711304
2025-07-29T18:12:43.332+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"0489aad6-848c-41b4-a217-51220a0f04cc","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:43.332+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"261e0604-b397-423c-8b5c-b102adb5e6c6","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:43.334+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:43.334+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"9bc5054f-2086-4293-9d0d-d8b308c57d94","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:43.335+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:43.335+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"fe8e9738-cf64-44dd-8747-aa9726d98c16","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:43.338+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@175a370d
2025-07-29T18:12:43.339+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@7ddc1bc9
2025-07-29T18:12:43.339+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@4070f3fd
2025-07-29T18:12:43.341+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5c34f945
2025-07-29T18:12:43.341+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@8c366e9
2025-07-29T18:12:43.341+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@38de9a16
2025-07-29T18:12:43.341+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@51487448
2025-07-29T18:12:43.341+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@22bdadec
2025-07-29T18:12:43.343+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5032b50
2025-07-29T18:12:43.343+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@244ec5b7
2025-07-29T18:12:43.343+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@6cab840c
2025-07-29T18:12:43.344+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3fb0874
2025-07-29T18:12:43.344+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4f4fc08a
2025-07-29T18:12:43.344+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@37929830
2025-07-29T18:12:43.345+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4ea47de
2025-07-29T18:12:43.345+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@9ac034c
2025-07-29T18:12:43.346+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@1c8dc23c
2025-07-29T18:12:43.347+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@dd82ce8
2025-07-29T18:12:43.347+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@71362390
2025-07-29T18:12:43.347+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4342a3a5
2025-07-29T18:12:43.348+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@143343e3
2025-07-29T18:12:43.348+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3a4ce2ee
2025-07-29T18:12:43.348+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5d8e77f1
2025-07-29T18:12:43.349+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:43.349+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:43.349+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:43.349+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:43.349+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:43.350+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:43.350+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@28b43bdb
2025-07-29T18:12:43.351+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@12137361
2025-07-29T18:12:43.351+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:43.351+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:43.351+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:43.351+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:43.352+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["2d250eb0-0c42-469a-8b29-628e13ab1820"],"client_context_id":"28c6d607-dc67-4eb5-b188-f44ab02619dd","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:43.352+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["22dd70f0-5f00-458c-acfd-7919d26f8ee0"],"client_context_id":"ac7e4133-d64c-4c38-9eac-a4c364872eab","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:43.352+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:43.352+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["0b2ccf95-86ad-4d3a-a0d5-028963a7498d"],"client_context_id":"c72377c8-13e7-4fac-9392-0ab291a9761b","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:43.352+08:00  INFO 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:43.353+08:00  INFO 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:43.354+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:43.355+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8"],"client_context_id":"e0f611a2-cb7c-4e2c-8f00-9b2a4c3610c7","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:43.355+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:43.355+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["a790aa4e-d9d7-4925-a97f-b811fcbf331b"],"client_context_id":"6723c906-da5c-4d27-92ce-8574ff4f9aa9","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:43.355+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : Failed to get QA stats for document 0b2ccf95-86ad-4d3a-a0d5-028963a7498d: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52276","lastDispatchedTo":"127.0.0.1:8093","requestId":199,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1024,"totalDispatchMicros":1024,"totalMicros":1661}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52276","lastDispatchedTo":"127.0.0.1:8093","requestId":199,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1024,"totalDispatchMicros":1024,"totalMicros":1661}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:12:43.355+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : Failed to get QA stats for document 2d250eb0-0c42-469a-8b29-628e13ab1820: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52252","lastDispatchedTo":"127.0.0.1:8093","requestId":197,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1503,"totalDispatchMicros":1503,"totalMicros":2121}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52252","lastDispatchedTo":"127.0.0.1:8093","requestId":197,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1503,"totalDispatchMicros":1503,"totalMicros":2121}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:12:43.355+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : Failed to get QA stats for document 22dd70f0-5f00-458c-acfd-7919d26f8ee0: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52268","lastDispatchedTo":"127.0.0.1:8093","requestId":198,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1223,"totalDispatchMicros":1223,"totalMicros":1877}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52268","lastDispatchedTo":"127.0.0.1:8093","requestId":198,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1223,"totalDispatchMicros":1223,"totalMicros":1877}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:12:43.358+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : Failed to get QA stats for document b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52252","lastDispatchedTo":"127.0.0.1:8093","requestId":200,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1372,"totalDispatchMicros":1372,"totalMicros":2281}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52252","lastDispatchedTo":"127.0.0.1:8093","requestId":200,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1372,"totalDispatchMicros":1372,"totalMicros":2281}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:12:43.358+08:00 ERROR 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : Failed to get QA stats for document a790aa4e-d9d7-4925-a97f-b811fcbf331b: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52268","lastDispatchedTo":"127.0.0.1:8093","requestId":201,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1345,"totalDispatchMicros":1345,"totalMicros":1867}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52268","lastDispatchedTo":"127.0.0.1:8093","requestId":201,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1345,"totalDispatchMicros":1345,"totalMicros":1867}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:12:43.367+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:43.367+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@3e142e22
2025-07-29T18:12:43.369+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:43.369+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:43.370+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-9] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:43.370+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:43.370+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@33404468
2025-07-29T18:12:43.370+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@46463ced
2025-07-29T18:12:43.371+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@582bc3ed
2025-07-29T18:12:43.371+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"e98f4fc6-b059-4219-9aee-e4ab73111d80","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:43.373+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:43.373+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:43.373+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"66547aeb-91fe-4f34-8c30-a062d201e102","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:43.374+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:43.374+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"269effad-ecc7-439c-881b-99e3fdd36459","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:43.374+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:43.374+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"1dfdf783-ead2-442d-944a-ee9f2f44b83c","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:43.374+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@7ab3b7cd
2025-07-29T18:12:43.376+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:43.378+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@28a85a5b
2025-07-29T18:12:43.378+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"95b070b9-4036-40c9-b2a0-a2f2b1adfc9a","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:43.378+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@5603c4da
2025-07-29T18:12:43.378+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@34d62ced
2025-07-29T18:12:43.378+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@20e1b2a5
2025-07-29T18:12:43.380+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@2a2ae71f
2025-07-29T18:12:43.381+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@28e6970d
2025-07-29T18:12:43.381+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@22faedab
2025-07-29T18:12:43.381+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@6c2e2daa
2025-07-29T18:12:43.382+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@2ef2694a
2025-07-29T18:12:43.382+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@47719a08
2025-07-29T18:12:43.382+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@767efd04
2025-07-29T18:12:43.382+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@79fcc69c
2025-07-29T18:12:43.383+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@31882788
2025-07-29T18:12:43.383+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@41c30da0
2025-07-29T18:12:43.384+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@472c94a7
2025-07-29T18:12:43.384+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@eaa3c1a
2025-07-29T18:12:43.384+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@27791dfd
2025-07-29T18:12:43.384+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5b98c960
2025-07-29T18:12:43.385+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@6c9afba7
2025-07-29T18:12:43.386+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@f41ad8c
2025-07-29T18:12:43.386+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@b1ed866
2025-07-29T18:12:43.387+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3398e82c
2025-07-29T18:12:43.387+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:43.387+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-9] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:43.387+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:43.387+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-9] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:43.387+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:43.387+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:43.388+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:43.388+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@69fbdb9
2025-07-29T18:12:43.388+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:43.389+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:43.389+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:43.390+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@61f56f78
2025-07-29T18:12:43.390+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["2d250eb0-0c42-469a-8b29-628e13ab1820"],"client_context_id":"f7a6cd8d-36b0-4900-9a23-5b94fa948fbd","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:43.390+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["0b2ccf95-86ad-4d3a-a0d5-028963a7498d"],"client_context_id":"4c853bcb-3170-4e90-b2dd-116c12365b0b","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:43.391+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:43.391+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["22dd70f0-5f00-458c-acfd-7919d26f8ee0"],"client_context_id":"51596de6-9867-49af-bc87-28d66f4f7aea","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:43.391+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:43.391+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@e8c004e
2025-07-29T18:12:43.392+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["a790aa4e-d9d7-4925-a97f-b811fcbf331b"],"client_context_id":"2156b2b8-51b6-497f-ae9c-ea6a9d3eabee","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:43.393+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:43.393+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : Failed to get QA stats for document 0b2ccf95-86ad-4d3a-a0d5-028963a7498d: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52268","lastDispatchedTo":"127.0.0.1:8093","requestId":237,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1105,"totalDispatchMicros":1105,"totalMicros":2032}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52268","lastDispatchedTo":"127.0.0.1:8093","requestId":237,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1105,"totalDispatchMicros":1105,"totalMicros":2032}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:12:43.393+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-9] c.e.a.e.controller.QAController          : Failed to get QA stats for document 2d250eb0-0c42-469a-8b29-628e13ab1820: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52252","lastDispatchedTo":"127.0.0.1:8093","requestId":236,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1490,"totalDispatchMicros":1490,"totalMicros":2302}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52252","lastDispatchedTo":"127.0.0.1:8093","requestId":236,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1490,"totalDispatchMicros":1490,"totalMicros":2302}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:12:43.395+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:43.394+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : Failed to get QA stats for document 22dd70f0-5f00-458c-acfd-7919d26f8ee0: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52276","lastDispatchedTo":"127.0.0.1:8093","requestId":238,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1844,"totalDispatchMicros":1844,"totalMicros":2688}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52276","lastDispatchedTo":"127.0.0.1:8093","requestId":238,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1844,"totalDispatchMicros":1844,"totalMicros":2688}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:12:43.395+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : Failed to get QA stats for document a790aa4e-d9d7-4925-a97f-b811fcbf331b: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52284","lastDispatchedTo":"127.0.0.1:8093","requestId":240,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1715,"totalDispatchMicros":1715,"totalMicros":2717}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52284","lastDispatchedTo":"127.0.0.1:8093","requestId":240,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1715,"totalDispatchMicros":1715,"totalMicros":2717}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:12:43.397+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:43.398+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8"],"client_context_id":"8f96d38a-6192-4b2b-957d-e2ae70d24bdc","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:43.401+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : Failed to get QA stats for document b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52252","lastDispatchedTo":"127.0.0.1:8093","requestId":241,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1848,"totalDispatchMicros":1848,"totalMicros":2851}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:52252","lastDispatchedTo":"127.0.0.1:8093","requestId":241,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1848,"totalDispatchMicros":1848,"totalMicros":2851}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:12:54.838+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:54.839+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@541616ef
2025-07-29T18:12:54.841+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:54.841+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"fbca81e9-91e0-4ac9-8b1e-2b475fa3a27d","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:54.846+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@79c9c42b
2025-07-29T18:12:54.847+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@58d22483
2025-07-29T18:12:54.848+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3c17f018
2025-07-29T18:12:54.849+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3ed6c2ea
2025-07-29T18:12:54.850+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3d426218
2025-07-29T18:12:54.851+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:54.851+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:54.852+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:54.853+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8"],"client_context_id":"810322cc-caa9-4eb3-8ff7-47d31f3e833c","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:54.855+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : Failed to retrieve QA pairs for document b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:51432","lastDispatchedTo":"127.0.0.1:8093","requestId":257,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1016,"totalDispatchMicros":1016,"totalMicros":1607}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:51432","lastDispatchedTo":"127.0.0.1:8093","requestId":257,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1016,"totalDispatchMicros":1016,"totalMicros":1607}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAs(QAController.java:49) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:12:54.866+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:54.866+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@f37ae13
2025-07-29T18:12:54.868+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:54.869+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"b35ca5d9-3053-43f3-bf55-e2af4d9590ca","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:54.873+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@5cbfd901
2025-07-29T18:12:54.875+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@64c0fc50
2025-07-29T18:12:54.876+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@79c35013
2025-07-29T18:12:54.877+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5b16e9fb
2025-07-29T18:12:54.879+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3857bcb5
2025-07-29T18:12:54.881+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:54.881+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:54.882+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:54.883+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8"],"client_context_id":"1ffe4fe9-f164-4e21-a44a-3e85052257c6","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:54.885+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : Failed to retrieve QA pairs for document b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:51432","lastDispatchedTo":"127.0.0.1:8093","requestId":265,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1141,"totalDispatchMicros":1141,"totalMicros":1786}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:51432","lastDispatchedTo":"127.0.0.1:8093","requestId":265,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1141,"totalDispatchMicros":1141,"totalMicros":1786}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAs(QAController.java:49) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:12:56.871+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=25c8b4ae-9124-4647-98a3-a922cd3cbe04 scope: AI collection: dataset options: com.couchbase.client.java.kv.GetOptions@3506b879
2025-07-29T18:12:56.873+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: document options: null statement: SELECT `_class`, META(`document`).`id` AS __id, `datasetId`, `fileName`, `fullPath`, `storageType`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `document` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.Document" AND `datasetId` = $1
2025-07-29T18:12:56.873+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["25c8b4ae-9124-4647-98a3-a922cd3cbe04"],"client_context_id":"26a6ee2a-b195-4560-9a53-d9166c7e824d","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:56.892+08:00  INFO 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:56.892+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:56.893+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@4185be3d
2025-07-29T18:12:56.893+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@6b368a3f
2025-07-29T18:12:56.894+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:56.894+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-9] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:56.894+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@313e7366
2025-07-29T18:12:56.895+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@b650538
2025-07-29T18:12:56.895+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:12:56.895+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:56.895+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:56.895+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@5602ac74
2025-07-29T18:12:56.896+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"415cd105-ab90-4443-bc24-a088e7df5ae7","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:56.896+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"c5d0448f-d619-4c2d-91d3-d2b86de1af59","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:56.896+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:56.896+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:56.897+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"e4e414c3-dacd-456c-b839-a32842a6f8c2","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:56.897+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:12:56.897+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"816e807b-7d34-484f-936a-6ded89e5c499","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:56.898+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"61a42363-4885-47aa-ac56-878eaad76704","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:12:56.902+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@3875c149
2025-07-29T18:12:56.902+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@3acd8ffb
2025-07-29T18:12:56.902+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@48045517
2025-07-29T18:12:56.902+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@6eefdb7b
2025-07-29T18:12:56.903+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@6f1f4b8d
2025-07-29T18:12:56.903+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@8f04fd4
2025-07-29T18:12:56.903+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@bb65989
2025-07-29T18:12:56.903+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@2652865c
2025-07-29T18:12:56.903+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@67c14ba2
2025-07-29T18:12:56.904+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@28ac36ad
2025-07-29T18:12:56.904+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4a97a8ef
2025-07-29T18:12:56.905+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@38795217
2025-07-29T18:12:56.904+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@48943587
2025-07-29T18:12:56.904+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@1a1a8bbb
2025-07-29T18:12:56.905+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@b43ba45
2025-07-29T18:12:56.905+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@75919d28
2025-07-29T18:12:56.906+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@adc4ff5
2025-07-29T18:12:56.906+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@779044ec
2025-07-29T18:12:56.906+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@7682ba93
2025-07-29T18:12:56.906+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@77a7230d
2025-07-29T18:12:56.907+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@63f8655a
2025-07-29T18:12:56.907+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@1af879d6
2025-07-29T18:12:56.907+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@2174afb2
2025-07-29T18:12:56.907+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@1cc4f5b9
2025-07-29T18:12:56.908+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@62f15d57
2025-07-29T18:12:56.908+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:56.908+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:56.908+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:56.908+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:56.909+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-9] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:56.909+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:56.909+08:00  INFO 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:12:56.909+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-9] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:56.909+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:56.909+08:00  INFO 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:12:56.910+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:56.910+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:56.910+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:56.910+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:56.911+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["22dd70f0-5f00-458c-acfd-7919d26f8ee0"],"client_context_id":"190686a0-ea3a-45ae-a3bc-4af05cd30f50","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:56.911+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:12:56.911+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["2d250eb0-0c42-469a-8b29-628e13ab1820"],"client_context_id":"21337148-2dca-4d36-8066-82d9d8cb27e1","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:56.911+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["a790aa4e-d9d7-4925-a97f-b811fcbf331b"],"client_context_id":"6271e12f-1076-4270-bee0-4ad8ac4265a2","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:56.911+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8"],"client_context_id":"71be32b4-eaa3-4d12-992f-e5608459f339","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:56.912+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["0b2ccf95-86ad-4d3a-a0d5-028963a7498d"],"client_context_id":"447f0bdd-be28-442a-b911-b45fde011fc0","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:12:56.914+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : Failed to get QA stats for document 22dd70f0-5f00-458c-acfd-7919d26f8ee0: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:51454","lastDispatchedTo":"127.0.0.1:8093","requestId":305,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1707,"totalDispatchMicros":1707,"totalMicros":2286}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:51454","lastDispatchedTo":"127.0.0.1:8093","requestId":305,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1707,"totalDispatchMicros":1707,"totalMicros":2286}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:12:56.914+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : Failed to get QA stats for document 2d250eb0-0c42-469a-8b29-628e13ab1820: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:51460","lastDispatchedTo":"127.0.0.1:8093","requestId":306,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1148,"totalDispatchMicros":1148,"totalMicros":1898}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:51460","lastDispatchedTo":"127.0.0.1:8093","requestId":306,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1148,"totalDispatchMicros":1148,"totalMicros":1898}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:12:56.914+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-9] c.e.a.e.controller.QAController          : Failed to get QA stats for document a790aa4e-d9d7-4925-a97f-b811fcbf331b: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:51462","lastDispatchedTo":"127.0.0.1:8093","requestId":307,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":825,"totalDispatchMicros":825,"totalMicros":1346}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:51462","lastDispatchedTo":"127.0.0.1:8093","requestId":307,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":825,"totalDispatchMicros":825,"totalMicros":1346}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:12:56.914+08:00 ERROR 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : Failed to get QA stats for document 0b2ccf95-86ad-4d3a-a0d5-028963a7498d: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:51438","lastDispatchedTo":"127.0.0.1:8093","requestId":309,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":886,"totalDispatchMicros":886,"totalMicros":1169}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:51438","lastDispatchedTo":"127.0.0.1:8093","requestId":309,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":886,"totalDispatchMicros":886,"totalMicros":1169}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:12:56.914+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : Failed to get QA stats for document b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:51476","lastDispatchedTo":"127.0.0.1:8093","requestId":308,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":859,"totalDispatchMicros":859,"totalMicros":1255}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:51476","lastDispatchedTo":"127.0.0.1:8093","requestId":308,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":859,"totalDispatchMicros":859,"totalMicros":1255}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:13:55.110+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=25c8b4ae-9124-4647-98a3-a922cd3cbe04 scope: AI collection: dataset options: com.couchbase.client.java.kv.GetOptions@4bec7951
2025-07-29T18:13:55.111+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: document options: null statement: SELECT `_class`, META(`document`).`id` AS __id, `datasetId`, `fileName`, `fullPath`, `storageType`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `document` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.Document" AND `datasetId` = $1
2025-07-29T18:13:55.112+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["25c8b4ae-9124-4647-98a3-a922cd3cbe04"],"client_context_id":"d986889e-7bf4-4716-a99f-6cb3b30a844e","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:13:55.124+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=25c8b4ae-9124-4647-98a3-a922cd3cbe04 scope: AI collection: dataset options: com.couchbase.client.java.kv.GetOptions@4dcc9822
2025-07-29T18:13:55.125+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: document options: null statement: SELECT `_class`, META(`document`).`id` AS __id, `datasetId`, `fileName`, `fullPath`, `storageType`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `document` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.Document" AND `datasetId` = $1
2025-07-29T18:13:55.126+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["25c8b4ae-9124-4647-98a3-a922cd3cbe04"],"client_context_id":"03af0e77-54e8-4ee5-816a-810362f3e35b","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:13:55.328+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-9] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:13:55.328+08:00  INFO 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:13:55.328+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:13:55.329+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:13:55.329+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:13:55.329+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@73d7e3ab
2025-07-29T18:13:55.329+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@32a8983
2025-07-29T18:13:55.330+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@67daa320
2025-07-29T18:13:55.330+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@5cbf572e
2025-07-29T18:13:55.330+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@6dd9f4cc
2025-07-29T18:13:55.331+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:13:55.331+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:13:55.332+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:13:55.332+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"ee4582a3-bc4b-48bc-9cd8-5137199300f5","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:13:55.332+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"b118a90b-4f07-4229-8669-ecfacd0586ff","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:13:55.332+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"3ab4e045-14c6-46b9-bfd0-22709082871c","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:13:55.332+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:13:55.333+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:13:55.334+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"506899c8-a670-45d0-ac1e-1130e70226bf","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:13:55.334+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"a49ef114-3361-4a32-a430-5f87fbef8aeb","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:13:55.338+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@38f8dd62
2025-07-29T18:13:55.340+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@eeecfa3
2025-07-29T18:13:55.340+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@2177e45e
2025-07-29T18:13:55.341+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@4e1d9427
2025-07-29T18:13:55.341+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@3891503b
2025-07-29T18:13:55.341+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@1fb14e9d
2025-07-29T18:13:55.347+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@1e6f0fc2
2025-07-29T18:13:55.349+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3e7e0f38
2025-07-29T18:13:55.350+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@8a89b1f
2025-07-29T18:13:55.350+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5236b1b8
2025-07-29T18:13:55.350+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@35b8aba8
2025-07-29T18:13:55.351+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3c32f757
2025-07-29T18:13:55.351+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@694fefe5
2025-07-29T18:13:55.352+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3ad9ea89
2025-07-29T18:13:55.352+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@74968af7
2025-07-29T18:13:55.352+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@383333ef
2025-07-29T18:13:55.353+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@793edc0f
2025-07-29T18:13:55.354+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@17222c63
2025-07-29T18:13:55.354+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4755a939
2025-07-29T18:13:55.354+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@40d8709d
2025-07-29T18:13:55.354+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3bb16c8e
2025-07-29T18:13:55.355+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@423a7750
2025-07-29T18:13:55.356+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5205c2e8
2025-07-29T18:13:55.355+08:00  INFO 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:13:55.356+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:13:55.356+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@192f6b73
2025-07-29T18:13:55.357+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@7098f7a4
2025-07-29T18:13:55.357+08:00  INFO 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:13:55.357+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:13:55.358+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-9] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:13:55.357+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:13:55.358+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:13:55.358+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:13:55.358+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-9] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:13:55.359+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:13:55.359+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:13:55.360+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:13:55.360+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:13:55.361+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8"],"client_context_id":"ab559769-712f-43db-a530-5c844873950d","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:13:55.360+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:13:55.360+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["2d250eb0-0c42-469a-8b29-628e13ab1820"],"client_context_id":"d4406ba8-4f66-4e11-9fbc-8aa78b5f4826","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:13:55.361+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:13:55.361+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["a790aa4e-d9d7-4925-a97f-b811fcbf331b"],"client_context_id":"d8439494-5583-469a-8486-7d92aed1a701","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:13:55.363+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["0b2ccf95-86ad-4d3a-a0d5-028963a7498d"],"client_context_id":"d5e7e933-15d7-4a21-b493-c6412e42245d","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:13:55.363+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["22dd70f0-5f00-458c-acfd-7919d26f8ee0"],"client_context_id":"7c087fa5-9f41-4207-8034-0404b0ef82d4","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:13:55.365+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : Failed to get QA stats for document 2d250eb0-0c42-469a-8b29-628e13ab1820: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:55742","lastDispatchedTo":"127.0.0.1:8093","requestId":402,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1461,"totalDispatchMicros":1461,"totalMicros":2521}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:55742","lastDispatchedTo":"127.0.0.1:8093","requestId":402,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1461,"totalDispatchMicros":1461,"totalMicros":2521}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:13:55.365+08:00 ERROR 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : Failed to get QA stats for document b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:55728","lastDispatchedTo":"127.0.0.1:8093","requestId":401,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":2235,"totalDispatchMicros":2235,"totalMicros":3297}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:55728","lastDispatchedTo":"127.0.0.1:8093","requestId":401,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":2235,"totalDispatchMicros":2235,"totalMicros":3297}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:13:55.366+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-9] c.e.a.e.controller.QAController          : Failed to get QA stats for document a790aa4e-d9d7-4925-a97f-b811fcbf331b: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:55750","lastDispatchedTo":"127.0.0.1:8093","requestId":403,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1234,"totalDispatchMicros":1234,"totalMicros":1934}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:55750","lastDispatchedTo":"127.0.0.1:8093","requestId":403,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1234,"totalDispatchMicros":1234,"totalMicros":1934}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:13:55.367+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : Failed to get QA stats for document 0b2ccf95-86ad-4d3a-a0d5-028963a7498d: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:55756","lastDispatchedTo":"127.0.0.1:8093","requestId":404,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1695,"totalDispatchMicros":1695,"totalMicros":2673}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:55756","lastDispatchedTo":"127.0.0.1:8093","requestId":404,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1695,"totalDispatchMicros":1695,"totalMicros":2673}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:13:55.367+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : Failed to get QA stats for document 22dd70f0-5f00-458c-acfd-7919d26f8ee0: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:55712","lastDispatchedTo":"127.0.0.1:8093","requestId":405,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1055,"totalDispatchMicros":1055,"totalMicros":1882}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:55712","lastDispatchedTo":"127.0.0.1:8093","requestId":405,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1055,"totalDispatchMicros":1055,"totalMicros":1882}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:13:55.375+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:13:55.376+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@4247b7c
2025-07-29T18:13:55.385+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:13:55.385+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"8bd05237-5f28-4b5b-96ad-e67c8a4f32a1","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:13:55.390+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@a95d75
2025-07-29T18:13:55.391+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@26380a84
2025-07-29T18:13:55.392+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@602c7afd
2025-07-29T18:13:55.393+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4774121f
2025-07-29T18:13:55.394+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@d7cbd71
2025-07-29T18:13:55.395+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:13:55.396+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:13:55.398+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:13:55.398+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["2d250eb0-0c42-469a-8b29-628e13ab1820"],"client_context_id":"ac101b90-e9da-41b6-8007-bfe654bc85f6","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:13:55.401+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : Failed to get QA stats for document 2d250eb0-0c42-469a-8b29-628e13ab1820: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:55728","lastDispatchedTo":"127.0.0.1:8093","requestId":413,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1300,"totalDispatchMicros":1300,"totalMicros":2133}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:55728","lastDispatchedTo":"127.0.0.1:8093","requestId":413,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1300,"totalDispatchMicros":1300,"totalMicros":2133}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:13:55.702+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:13:55.702+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:13:55.702+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:13:55.702+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:13:55.703+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@555c2200
2025-07-29T18:13:55.703+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@48fb273a
2025-07-29T18:13:55.703+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@67dc9967
2025-07-29T18:13:55.703+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@79fd7ff1
2025-07-29T18:13:55.705+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:13:55.705+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"fdee0108-904c-4125-b922-faa36789041c","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:13:55.705+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:13:55.705+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:13:55.706+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"b65501f9-1d00-4f4c-9636-2f568ab998de","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:13:55.706+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:13:55.706+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"523be5a9-20b4-4b9f-987f-d83515c45be1","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:13:55.707+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"15dc7f04-92d7-4bc9-9de5-c1e68fdcd3bb","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:13:55.710+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@4607769a
2025-07-29T18:13:55.710+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@167295d8
2025-07-29T18:13:55.710+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@4111923d
2025-07-29T18:13:55.711+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4642cb53
2025-07-29T18:13:55.711+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3efc50b6
2025-07-29T18:13:55.711+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@2f208914
2025-07-29T18:13:55.711+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@57818074
2025-07-29T18:13:55.712+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@7fc12575
2025-07-29T18:13:55.712+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@52857706
2025-07-29T18:13:55.712+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@684195a
2025-07-29T18:13:55.712+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@24adbcf6
2025-07-29T18:13:55.713+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4bb944af
2025-07-29T18:13:55.713+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5191db90
2025-07-29T18:13:55.713+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@17d72c47
2025-07-29T18:13:55.713+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@74dc5316
2025-07-29T18:13:55.713+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4967c455
2025-07-29T18:13:55.714+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@2c5fd49e
2025-07-29T18:13:55.714+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5a9ac4fa
2025-07-29T18:13:55.714+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@664ca88b
2025-07-29T18:13:55.714+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:13:55.715+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:13:55.715+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:13:55.715+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:13:55.715+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:13:55.715+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3d951616
2025-07-29T18:13:55.716+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:13:55.717+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:13:55.717+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:13:55.717+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["22dd70f0-5f00-458c-acfd-7919d26f8ee0"],"client_context_id":"743a96ae-6531-40d8-89bd-81f1c2aefeaf","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:13:55.717+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:13:55.717+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:13:55.718+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:13:55.718+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["0b2ccf95-86ad-4d3a-a0d5-028963a7498d"],"client_context_id":"fd0390cc-c9a2-4ccb-8488-4f045be3c92a","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:13:55.718+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["a790aa4e-d9d7-4925-a97f-b811fcbf331b"],"client_context_id":"63e74e30-df04-4af1-b6cd-c220fcd58bae","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:13:55.719+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:13:55.720+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8"],"client_context_id":"a7750f38-0502-4022-8c6a-fa4215bb197d","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:13:55.721+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : Failed to get QA stats for document 22dd70f0-5f00-458c-acfd-7919d26f8ee0: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:55728","lastDispatchedTo":"127.0.0.1:8093","requestId":442,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":2028,"totalDispatchMicros":2028,"totalMicros":2668}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:55728","lastDispatchedTo":"127.0.0.1:8093","requestId":442,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":2028,"totalDispatchMicros":2028,"totalMicros":2668}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:13:55.721+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : Failed to get QA stats for document 0b2ccf95-86ad-4d3a-a0d5-028963a7498d: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:55742","lastDispatchedTo":"127.0.0.1:8093","requestId":443,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1242,"totalDispatchMicros":1242,"totalMicros":1711}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:55742","lastDispatchedTo":"127.0.0.1:8093","requestId":443,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1242,"totalDispatchMicros":1242,"totalMicros":1711}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:13:55.721+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : Failed to get QA stats for document a790aa4e-d9d7-4925-a97f-b811fcbf331b: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:55750","lastDispatchedTo":"127.0.0.1:8093","requestId":444,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1033,"totalDispatchMicros":1033,"totalMicros":1484}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:55750","lastDispatchedTo":"127.0.0.1:8093","requestId":444,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1033,"totalDispatchMicros":1033,"totalMicros":1484}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:13:55.723+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : Failed to get QA stats for document b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:55756","lastDispatchedTo":"127.0.0.1:8093","requestId":445,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1514,"totalDispatchMicros":1514,"totalMicros":2021}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:55756","lastDispatchedTo":"127.0.0.1:8093","requestId":445,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1514,"totalDispatchMicros":1514,"totalMicros":2021}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:14:49.666+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=25c8b4ae-9124-4647-98a3-a922cd3cbe04 scope: AI collection: dataset options: com.couchbase.client.java.kv.GetOptions@2c815393
2025-07-29T18:14:49.667+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: document options: null statement: SELECT `_class`, META(`document`).`id` AS __id, `datasetId`, `fileName`, `fullPath`, `storageType`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `document` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.Document" AND `datasetId` = $1
2025-07-29T18:14:49.668+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["25c8b4ae-9124-4647-98a3-a922cd3cbe04"],"client_context_id":"5fb88136-6ec2-4dc7-a017-31f4ead9f6c4","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:14:49.679+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=25c8b4ae-9124-4647-98a3-a922cd3cbe04 scope: AI collection: dataset options: com.couchbase.client.java.kv.GetOptions@1e4deb12
2025-07-29T18:14:49.680+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: document options: null statement: SELECT `_class`, META(`document`).`id` AS __id, `datasetId`, `fileName`, `fullPath`, `storageType`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `document` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.Document" AND `datasetId` = $1
2025-07-29T18:14:49.681+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["25c8b4ae-9124-4647-98a3-a922cd3cbe04"],"client_context_id":"6df7da5d-c673-40ba-830f-8cf68ed089c3","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:14:49.792+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:14:49.792+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:14:49.792+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:14:49.792+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:14:49.792+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:14:49.792+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@5a41f9a7
2025-07-29T18:14:49.793+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@f8d8d95
2025-07-29T18:14:49.793+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@79aaac99
2025-07-29T18:14:49.793+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@62439d97
2025-07-29T18:14:49.793+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@100e933c
2025-07-29T18:14:49.795+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:14:49.795+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:14:49.795+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"bcebb99a-0732-4b35-9100-d4c37d05c041","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:14:49.795+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:14:49.795+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"d4950c14-465c-4959-9a61-cd78428a8d05","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:14:49.795+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:14:49.795+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:14:49.796+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"e3bebebd-58d2-4f85-af63-d163728f6ae2","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:14:49.796+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"63850b4d-f76d-433a-9960-04f61c52459e","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:14:49.796+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"751763cc-eed5-49cc-9c1c-7195a1aab860","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:14:49.800+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@8e83d55
2025-07-29T18:14:49.801+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@48efc97f
2025-07-29T18:14:49.802+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@488b174b
2025-07-29T18:14:49.802+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@1295f54b
2025-07-29T18:14:49.802+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@3b0bedd4
2025-07-29T18:14:49.802+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5258a26b
2025-07-29T18:14:49.803+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@3c9cf9ff
2025-07-29T18:14:49.803+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@276a0152
2025-07-29T18:14:49.803+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@175ce101
2025-07-29T18:14:49.803+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@d2eb2f
2025-07-29T18:14:49.803+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@701e546
2025-07-29T18:14:49.803+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@46f8a609
2025-07-29T18:14:49.804+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@44e8d10f
2025-07-29T18:14:49.804+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3b3e4917
2025-07-29T18:14:49.804+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4eca6266
2025-07-29T18:14:49.805+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@228b4a99
2025-07-29T18:14:49.805+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@7e037187
2025-07-29T18:14:49.805+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@321de49c
2025-07-29T18:14:49.806+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@10941d9b
2025-07-29T18:14:49.805+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@16da1d38
2025-07-29T18:14:49.805+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:14:49.806+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@662d5029
2025-07-29T18:14:49.807+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@569cca46
2025-07-29T18:14:49.807+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4b9c4d77
2025-07-29T18:14:49.807+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@6fb61e7
2025-07-29T18:14:49.808+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:14:49.809+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5b2fce0a
2025-07-29T18:14:49.809+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:14:49.809+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:14:49.810+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:14:49.810+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:14:49.810+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:14:49.810+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:14:49.810+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:14:49.811+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:14:49.811+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:14:49.811+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:14:49.812+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:14:49.811+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["22dd70f0-5f00-458c-acfd-7919d26f8ee0"],"client_context_id":"97dbf947-4ed9-4d07-8184-114ba210f998","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:14:49.812+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:14:49.812+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["2d250eb0-0c42-469a-8b29-628e13ab1820"],"client_context_id":"a8bcdf57-d5a0-4444-939a-e4564dee94cb","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:14:49.812+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["a790aa4e-d9d7-4925-a97f-b811fcbf331b"],"client_context_id":"99a78e7f-1b8a-4f08-a63e-c242b1e262fe","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:14:49.813+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["0b2ccf95-86ad-4d3a-a0d5-028963a7498d"],"client_context_id":"539f125b-2a30-4e58-bf19-6b7a446fc1b2","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:14:49.813+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:14:49.814+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8"],"client_context_id":"d4157e42-1f87-4853-bbae-fe9f5a8f6d85","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:14:49.815+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : Failed to get QA stats for document a790aa4e-d9d7-4925-a97f-b811fcbf331b: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57964","lastDispatchedTo":"127.0.0.1:8093","requestId":525,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":941,"totalDispatchMicros":941,"totalMicros":1380}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57964","lastDispatchedTo":"127.0.0.1:8093","requestId":525,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":941,"totalDispatchMicros":941,"totalMicros":1380}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:14:49.815+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : Failed to get QA stats for document 0b2ccf95-86ad-4d3a-a0d5-028963a7498d: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57978","lastDispatchedTo":"127.0.0.1:8093","requestId":526,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":782,"totalDispatchMicros":782,"totalMicros":1307}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57978","lastDispatchedTo":"127.0.0.1:8093","requestId":526,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":782,"totalDispatchMicros":782,"totalMicros":1307}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:14:49.815+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : Failed to get QA stats for document 2d250eb0-0c42-469a-8b29-628e13ab1820: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57954","lastDispatchedTo":"127.0.0.1:8093","requestId":524,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":995,"totalDispatchMicros":995,"totalMicros":1468}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57954","lastDispatchedTo":"127.0.0.1:8093","requestId":524,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":995,"totalDispatchMicros":995,"totalMicros":1468}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:14:49.815+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : Failed to get QA stats for document 22dd70f0-5f00-458c-acfd-7919d26f8ee0: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57948","lastDispatchedTo":"127.0.0.1:8093","requestId":523,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1578,"totalDispatchMicros":1578,"totalMicros":2136}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57948","lastDispatchedTo":"127.0.0.1:8093","requestId":523,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1578,"totalDispatchMicros":1578,"totalMicros":2136}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:14:49.816+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : Failed to get QA stats for document b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57938","lastDispatchedTo":"127.0.0.1:8093","requestId":527,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1087,"totalDispatchMicros":1087,"totalMicros":1529}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57938","lastDispatchedTo":"127.0.0.1:8093","requestId":527,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1087,"totalDispatchMicros":1087,"totalMicros":1529}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:14:49.822+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:14:49.822+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@61cf0a0a
2025-07-29T18:14:49.824+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:14:49.824+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"4a52e9b3-a3b5-44ad-9a6f-e7fddfde27e8","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:14:49.828+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@74ff9583
2025-07-29T18:14:49.829+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@321590f5
2025-07-29T18:14:49.830+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@77e505b8
2025-07-29T18:14:49.831+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@6ee3de14
2025-07-29T18:14:49.832+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@66b80dc6
2025-07-29T18:14:49.832+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:14:49.832+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:14:49.833+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:14:49.834+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["a790aa4e-d9d7-4925-a97f-b811fcbf331b"],"client_context_id":"27e78215-13ca-47d8-9500-7548f50eccc6","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:14:49.837+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : Failed to get QA stats for document a790aa4e-d9d7-4925-a97f-b811fcbf331b: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57948","lastDispatchedTo":"127.0.0.1:8093","requestId":535,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1531,"totalDispatchMicros":1531,"totalMicros":2160}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57948","lastDispatchedTo":"127.0.0.1:8093","requestId":535,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1531,"totalDispatchMicros":1531,"totalMicros":2160}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:14:50.164+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:14:50.164+08:00  INFO 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:14:50.164+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@721eb418
2025-07-29T18:14:50.164+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-9] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:14:50.164+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:14:50.164+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@510649d1
2025-07-29T18:14:50.165+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@29df1aa8
2025-07-29T18:14:50.165+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@1f2e84fc
2025-07-29T18:14:50.166+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:14:50.166+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"bcf7dc67-0023-4a4b-9b3b-b41293494a6b","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:14:50.166+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:14:50.166+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:14:50.166+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:14:50.167+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"e78a0084-765d-44e1-ad98-971f7680d737","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:14:50.167+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"7f7e1bbd-228e-457f-874f-880932918ec9","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:14:50.166+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"589b09bb-8f46-4779-a461-7bbae669e734","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:14:50.169+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@1a568f48
2025-07-29T18:14:50.170+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@63c00773
2025-07-29T18:14:50.169+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@46026a30
2025-07-29T18:14:50.170+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@57c126a6
2025-07-29T18:14:50.171+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3c6d4a5a
2025-07-29T18:14:50.171+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@1ef75b70
2025-07-29T18:14:50.171+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@2ddfb953
2025-07-29T18:14:50.171+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@15942c84
2025-07-29T18:14:50.172+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@67f83173
2025-07-29T18:14:50.172+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@2c2537be
2025-07-29T18:14:50.173+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5cbbc281
2025-07-29T18:14:50.173+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@57c6b0bf
2025-07-29T18:14:50.174+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@60c1e7e0
2025-07-29T18:14:50.174+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@47c74fa2
2025-07-29T18:14:50.174+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@de089e4
2025-07-29T18:14:50.174+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@346d3357
2025-07-29T18:14:50.174+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4ec3087f
2025-07-29T18:14:50.174+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@245f23b6
2025-07-29T18:14:50.175+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@58e62182
2025-07-29T18:14:50.175+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:14:50.175+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@6ac7c76a
2025-07-29T18:14:50.175+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:14:50.175+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:14:50.175+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-9] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:14:50.175+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:14:50.175+08:00  INFO 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:14:50.175+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-9] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:14:50.176+08:00  INFO 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:14:50.176+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:14:50.176+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:14:50.176+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:14:50.176+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["2d250eb0-0c42-469a-8b29-628e13ab1820"],"client_context_id":"29616b30-26a2-4545-9002-60574aa9284a","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:14:50.176+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:14:50.177+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["22dd70f0-5f00-458c-acfd-7919d26f8ee0"],"client_context_id":"5c5c281b-c2b6-4a9f-a6bc-e6883f800dcd","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:14:50.177+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8"],"client_context_id":"811790e3-e607-4fec-bb96-fdcb93edb4b9","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:14:50.177+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["0b2ccf95-86ad-4d3a-a0d5-028963a7498d"],"client_context_id":"002eec4f-f920-4b10-815f-499f95676e6f","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:14:50.179+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : Failed to get QA stats for document 2d250eb0-0c42-469a-8b29-628e13ab1820: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57948","lastDispatchedTo":"127.0.0.1:8093","requestId":565,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1050,"totalDispatchMicros":1050,"totalMicros":1555}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57948","lastDispatchedTo":"127.0.0.1:8093","requestId":565,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1050,"totalDispatchMicros":1050,"totalMicros":1555}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:14:50.180+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : Failed to get QA stats for document b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57964","lastDispatchedTo":"127.0.0.1:8093","requestId":567,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1295,"totalDispatchMicros":1295,"totalMicros":1586}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57964","lastDispatchedTo":"127.0.0.1:8093","requestId":567,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1295,"totalDispatchMicros":1295,"totalMicros":1586}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:14:50.180+08:00 ERROR 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : Failed to get QA stats for document 0b2ccf95-86ad-4d3a-a0d5-028963a7498d: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57978","lastDispatchedTo":"127.0.0.1:8093","requestId":568,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":954,"totalDispatchMicros":954,"totalMicros":1357}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57978","lastDispatchedTo":"127.0.0.1:8093","requestId":568,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":954,"totalDispatchMicros":954,"totalMicros":1357}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:14:50.180+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-9] c.e.a.e.controller.QAController          : Failed to get QA stats for document 22dd70f0-5f00-458c-acfd-7919d26f8ee0: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57954","lastDispatchedTo":"127.0.0.1:8093","requestId":566,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1449,"totalDispatchMicros":1449,"totalMicros":1986}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57954","lastDispatchedTo":"127.0.0.1:8093","requestId":566,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1449,"totalDispatchMicros":1449,"totalMicros":1986}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:14:55.997+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:14:55.998+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@780d7ab1
2025-07-29T18:14:55.999+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:14:56.000+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"16de3499-1f44-4758-94db-20b32d45570a","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:14:56.006+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@1bff83d1
2025-07-29T18:14:56.007+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4a9b926c
2025-07-29T18:14:56.008+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5950a17c
2025-07-29T18:14:56.008+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@69d600cf
2025-07-29T18:14:56.009+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@e50f72f
2025-07-29T18:14:56.010+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:14:56.010+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:14:56.011+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:14:56.011+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["0b2ccf95-86ad-4d3a-a0d5-028963a7498d"],"client_context_id":"7382cd73-5e7a-4bbe-9e6c-53748d0936ec","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:14:56.014+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : Failed to retrieve QA pairs for document 0b2ccf95-86ad-4d3a-a0d5-028963a7498d: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57980","lastDispatchedTo":"127.0.0.1:8093","requestId":579,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1201,"totalDispatchMicros":1201,"totalMicros":1761}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57980","lastDispatchedTo":"127.0.0.1:8093","requestId":579,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1201,"totalDispatchMicros":1201,"totalMicros":1761}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAs(QAController.java:49) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:14:56.114+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] o.springdoc.api.AbstractOpenApiResource  : Init duration for springdoc-openapi is: 2825 ms
2025-07-29T18:14:56.350+08:00  INFO 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:14:56.351+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@61885dd5
2025-07-29T18:14:56.353+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:14:56.354+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"e0634472-0f9d-4874-ab3b-eb61825027d6","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:14:56.359+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@7c2fa225
2025-07-29T18:14:56.361+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@48ebaf5b
2025-07-29T18:14:56.361+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3124e4c3
2025-07-29T18:14:56.362+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3f1725e5
2025-07-29T18:14:56.363+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3ea896a8
2025-07-29T18:14:56.364+08:00  INFO 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:14:56.364+08:00  INFO 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:14:56.366+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:14:56.366+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["0b2ccf95-86ad-4d3a-a0d5-028963a7498d"],"client_context_id":"88428cf1-d5c8-4375-85c0-78b73d1c56e7","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:14:56.369+08:00 ERROR 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : Failed to retrieve QA pairs for document 0b2ccf95-86ad-4d3a-a0d5-028963a7498d: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57980","lastDispatchedTo":"127.0.0.1:8093","requestId":588,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1148,"totalDispatchMicros":1148,"totalMicros":1643}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:57980","lastDispatchedTo":"127.0.0.1:8093","requestId":588,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1148,"totalDispatchMicros":1148,"totalMicros":1643}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAs(QAController.java:49) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:03.364+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=25c8b4ae-9124-4647-98a3-a922cd3cbe04 scope: AI collection: dataset options: com.couchbase.client.java.kv.GetOptions@3286dbf
2025-07-29T18:15:03.366+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: document options: null statement: SELECT `_class`, META(`document`).`id` AS __id, `datasetId`, `fileName`, `fullPath`, `storageType`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `document` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.Document" AND `datasetId` = $1
2025-07-29T18:15:03.366+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["25c8b4ae-9124-4647-98a3-a922cd3cbe04"],"client_context_id":"9ce2cde5-9e9b-48b9-bee8-0bac3beb20b0","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:03.380+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:03.380+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@5ad53092
2025-07-29T18:15:03.382+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:03.383+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"28c6274b-e9c1-4700-9ae8-0fa1832d2e03","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:03.387+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@6ba3ca1c
2025-07-29T18:15:03.388+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@2f328f47
2025-07-29T18:15:03.389+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@32303231
2025-07-29T18:15:03.389+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4192d545
2025-07-29T18:15:03.390+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@34940441
2025-07-29T18:15:03.391+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:03.391+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:03.393+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:03.393+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["0b2ccf95-86ad-4d3a-a0d5-028963a7498d"],"client_context_id":"5b5119aa-2f2c-4310-b09e-db31dfc69750","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:03.396+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : Failed to get QA stats for document 0b2ccf95-86ad-4d3a-a0d5-028963a7498d: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59778","lastDispatchedTo":"127.0.0.1:8093","requestId":603,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1719,"totalDispatchMicros":1719,"totalMicros":2270}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59778","lastDispatchedTo":"127.0.0.1:8093","requestId":603,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1719,"totalDispatchMicros":1719,"totalMicros":2270}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:03.640+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:03.641+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@368a6750
2025-07-29T18:15:03.642+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:03.643+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"03519c43-2415-46ae-b095-66479d1c0000","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:03.647+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@5ae98a34
2025-07-29T18:15:03.648+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4addd038
2025-07-29T18:15:03.648+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@1b0d7e9c
2025-07-29T18:15:03.649+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@7ed82a4a
2025-07-29T18:15:03.649+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@68f6b78f
2025-07-29T18:15:03.650+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:03.650+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:03.651+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:03.652+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["22dd70f0-5f00-458c-acfd-7919d26f8ee0"],"client_context_id":"1b6a8528-5c53-4ca4-ad87-8ce3f630ab95","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:03.654+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : Failed to get QA stats for document 22dd70f0-5f00-458c-acfd-7919d26f8ee0: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59778","lastDispatchedTo":"127.0.0.1:8093","requestId":611,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1434,"totalDispatchMicros":1434,"totalMicros":2125}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59778","lastDispatchedTo":"127.0.0.1:8093","requestId":611,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1434,"totalDispatchMicros":1434,"totalMicros":2125}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:03.708+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:03.708+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:03.708+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:03.708+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@57180d57
2025-07-29T18:15:03.709+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@366ba
2025-07-29T18:15:03.709+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@2c870e8b
2025-07-29T18:15:03.710+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:03.710+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:03.710+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"446e74cf-a752-4760-acca-33ee43cf0a05","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:03.710+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"85408ee3-f841-4fec-b22b-00e806a4c16f","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:03.711+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:03.711+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"91cb4d22-c45e-4be6-8e19-3f24524be39b","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:03.714+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@3fca6f0e
2025-07-29T18:15:03.714+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@33a063bc
2025-07-29T18:15:03.715+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@378a6f75
2025-07-29T18:15:03.715+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5af3008a
2025-07-29T18:15:03.715+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5b2d3bf2
2025-07-29T18:15:03.715+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@23edcc59
2025-07-29T18:15:03.716+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@56c4ac15
2025-07-29T18:15:03.716+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4080b09b
2025-07-29T18:15:03.716+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@2a162685
2025-07-29T18:15:03.716+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@41a1712f
2025-07-29T18:15:03.717+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@714c5ba9
2025-07-29T18:15:03.717+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@7075959e
2025-07-29T18:15:03.717+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@2d7fc40a
2025-07-29T18:15:03.718+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@41c17bbf
2025-07-29T18:15:03.718+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@14e0bd22
2025-07-29T18:15:03.718+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:03.718+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:03.719+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:03.719+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:03.719+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:03.719+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:03.720+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:03.720+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:03.720+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:03.721+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["2d250eb0-0c42-469a-8b29-628e13ab1820"],"client_context_id":"0c929aff-849b-42ac-8d38-9bc9d2a7a140","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:03.721+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8"],"client_context_id":"6f8f447c-49a9-4ead-a532-331c5267860b","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:03.721+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["a790aa4e-d9d7-4925-a97f-b811fcbf331b"],"client_context_id":"e03e4779-f8c2-44e4-a490-205fd56ed552","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:03.723+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : Failed to get QA stats for document b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59778","lastDispatchedTo":"127.0.0.1:8093","requestId":635,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1044,"totalDispatchMicros":1044,"totalMicros":1439}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59778","lastDispatchedTo":"127.0.0.1:8093","requestId":635,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1044,"totalDispatchMicros":1044,"totalMicros":1439}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:03.723+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : Failed to get QA stats for document 2d250eb0-0c42-469a-8b29-628e13ab1820: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59790","lastDispatchedTo":"127.0.0.1:8093","requestId":633,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1133,"totalDispatchMicros":1133,"totalMicros":1668}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59790","lastDispatchedTo":"127.0.0.1:8093","requestId":633,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1133,"totalDispatchMicros":1133,"totalMicros":1668}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:03.724+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : Failed to get QA stats for document a790aa4e-d9d7-4925-a97f-b811fcbf331b: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59796","lastDispatchedTo":"127.0.0.1:8093","requestId":634,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1403,"totalDispatchMicros":1403,"totalMicros":1869}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59796","lastDispatchedTo":"127.0.0.1:8093","requestId":634,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1403,"totalDispatchMicros":1403,"totalMicros":1869}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:04.906+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:04.907+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@1dc0a571
2025-07-29T18:15:04.909+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:04.910+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"79f3b444-b6f6-4afc-8713-4e1773babcce","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:04.916+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@7c65ab52
2025-07-29T18:15:04.918+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@700a2afc
2025-07-29T18:15:04.919+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@6879f2a1
2025-07-29T18:15:04.920+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@7a48c45f
2025-07-29T18:15:04.920+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@2b26df7f
2025-07-29T18:15:04.921+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:04.922+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:04.925+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:04.926+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8"],"client_context_id":"ec439957-733b-4958-84a3-f052d9f69e99","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:04.929+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : Failed to retrieve QA pairs for document b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59810","lastDispatchedTo":"127.0.0.1:8093","requestId":643,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":2021,"totalDispatchMicros":2021,"totalMicros":2742}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59810","lastDispatchedTo":"127.0.0.1:8093","requestId":643,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":2021,"totalDispatchMicros":2021,"totalMicros":2742}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAs(QAController.java:49) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:05.253+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:05.253+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@58c787a2
2025-07-29T18:15:05.255+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:05.256+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"ce486129-d8c0-44e0-8849-0dbf56f883b0","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:05.260+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@5b84c3ca
2025-07-29T18:15:05.261+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@bb6d52b
2025-07-29T18:15:05.262+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@26cb63bc
2025-07-29T18:15:05.263+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@42d50a50
2025-07-29T18:15:05.264+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3fb21b53
2025-07-29T18:15:05.264+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:05.265+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:05.266+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:05.267+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8"],"client_context_id":"d1c4741a-e093-44f9-839a-d448f2617795","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:05.269+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : Failed to retrieve QA pairs for document b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59810","lastDispatchedTo":"127.0.0.1:8093","requestId":652,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1284,"totalDispatchMicros":1284,"totalMicros":1805}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59810","lastDispatchedTo":"127.0.0.1:8093","requestId":652,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1284,"totalDispatchMicros":1284,"totalMicros":1805}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAs(QAController.java:49) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:06.734+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=25c8b4ae-9124-4647-98a3-a922cd3cbe04 scope: AI collection: dataset options: com.couchbase.client.java.kv.GetOptions@3b06ae44
2025-07-29T18:15:06.736+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: document options: null statement: SELECT `_class`, META(`document`).`id` AS __id, `datasetId`, `fileName`, `fullPath`, `storageType`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `document` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.Document" AND `datasetId` = $1
2025-07-29T18:15:06.737+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["25c8b4ae-9124-4647-98a3-a922cd3cbe04"],"client_context_id":"75b4cbfd-6c3c-4d11-b077-40c8dfea17f5","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:06.749+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:06.750+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@46b858a1
2025-07-29T18:15:06.751+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:06.752+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"3d312312-d83b-465a-9aaf-bf554a6f48c1","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:06.755+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@12c72b37
2025-07-29T18:15:06.756+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@790cc587
2025-07-29T18:15:06.757+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@352fed05
2025-07-29T18:15:06.758+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3156d651
2025-07-29T18:15:06.759+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@1ae3cddf
2025-07-29T18:15:06.759+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:06.760+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:06.761+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:06.761+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["0b2ccf95-86ad-4d3a-a0d5-028963a7498d"],"client_context_id":"c3d51441-7f31-4cea-8833-24586b9c1fff","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:06.764+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : Failed to get QA stats for document 0b2ccf95-86ad-4d3a-a0d5-028963a7498d: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59822","lastDispatchedTo":"127.0.0.1:8093","requestId":663,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1409,"totalDispatchMicros":1409,"totalMicros":2000}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59822","lastDispatchedTo":"127.0.0.1:8093","requestId":663,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1409,"totalDispatchMicros":1409,"totalMicros":2000}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:07.010+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:07.011+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@6b9a3562
2025-07-29T18:15:07.012+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:07.013+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"1461d5c8-7621-458c-ac5d-56495cb85e9d","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:07.017+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@7f38825c
2025-07-29T18:15:07.018+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4f06f66d
2025-07-29T18:15:07.019+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5c5ae79e
2025-07-29T18:15:07.020+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@66d1e852
2025-07-29T18:15:07.020+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5d40acb6
2025-07-29T18:15:07.021+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:07.022+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:07.023+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:07.023+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["22dd70f0-5f00-458c-acfd-7919d26f8ee0"],"client_context_id":"a4937f56-6acf-476e-95d0-3842b3305a8f","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:07.026+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : Failed to get QA stats for document 22dd70f0-5f00-458c-acfd-7919d26f8ee0: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59822","lastDispatchedTo":"127.0.0.1:8093","requestId":671,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1133,"totalDispatchMicros":1133,"totalMicros":1618}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59822","lastDispatchedTo":"127.0.0.1:8093","requestId":671,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1133,"totalDispatchMicros":1133,"totalMicros":1618}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:07.075+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:07.075+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@3327f9a
2025-07-29T18:15:07.077+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:07.077+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:07.077+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"1f0b0575-3a23-4ba4-88f2-cc0427b09e43","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:07.077+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:07.078+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@1e9ea7e4
2025-07-29T18:15:07.078+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@25c2cc2f
2025-07-29T18:15:07.079+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:07.079+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:07.079+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"3e5663aa-69e5-4712-9729-8be688de90a8","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:07.080+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"9b22e297-1e9b-4068-8872-b555ba125b45","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:07.081+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@5e25fabc
2025-07-29T18:15:07.082+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@652564ef
2025-07-29T18:15:07.082+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@656376a9
2025-07-29T18:15:07.083+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@753d1b30
2025-07-29T18:15:07.084+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4bcef31
2025-07-29T18:15:07.084+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@47cba887
2025-07-29T18:15:07.084+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@1539575d
2025-07-29T18:15:07.085+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:07.085+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5dd042c1
2025-07-29T18:15:07.085+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@218fe797
2025-07-29T18:15:07.085+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:07.086+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@361a6f18
2025-07-29T18:15:07.086+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@129fe43d
2025-07-29T18:15:07.086+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:07.086+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@9a63ab3
2025-07-29T18:15:07.087+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5f7bd0da
2025-07-29T18:15:07.087+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["a790aa4e-d9d7-4925-a97f-b811fcbf331b"],"client_context_id":"151827ec-6334-4544-8ae6-facbad834fe8","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:07.087+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@13332490
2025-07-29T18:15:07.088+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@a7f7d7
2025-07-29T18:15:07.088+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:07.088+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:07.088+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:07.089+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:07.089+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:07.089+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:07.090+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8"],"client_context_id":"6687c4a3-bd96-44e9-9579-8ddddeb3e07b","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:07.089+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : Failed to get QA stats for document a790aa4e-d9d7-4925-a97f-b811fcbf331b: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59826","lastDispatchedTo":"127.0.0.1:8093","requestId":691,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1316,"totalDispatchMicros":1316,"totalMicros":1752}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59826","lastDispatchedTo":"127.0.0.1:8093","requestId":691,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1316,"totalDispatchMicros":1316,"totalMicros":1752}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:07.090+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["2d250eb0-0c42-469a-8b29-628e13ab1820"],"client_context_id":"3050a23b-3e78-4ad4-a876-3e0b6d962687","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:07.092+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : Failed to get QA stats for document b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59826","lastDispatchedTo":"127.0.0.1:8093","requestId":694,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1033,"totalDispatchMicros":1033,"totalMicros":1522}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59826","lastDispatchedTo":"127.0.0.1:8093","requestId":694,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1033,"totalDispatchMicros":1033,"totalMicros":1522}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:07.092+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : Failed to get QA stats for document 2d250eb0-0c42-469a-8b29-628e13ab1820: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59838","lastDispatchedTo":"127.0.0.1:8093","requestId":695,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":730,"totalDispatchMicros":730,"totalMicros":1063}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:59838","lastDispatchedTo":"127.0.0.1:8093","requestId":695,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":730,"totalDispatchMicros":730,"totalMicros":1063}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:08.011+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: user options: null statement: SELECT `_class`, META(`user`).`id` AS __id, `name`, `email`, `password`, `status`, `systemRoles`, `teamMembershipIds`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `user` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.User" AND `email` = $1
2025-07-29T18:15:08.017+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin@example.com"],"client_context_id":"2b93c66a-7cdc-418e-a561-28ca6607d54e","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:08.089+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:08.090+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"561c2683-0c26-4ba0-ba99-aacff2389334","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:08.094+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@214aca11
2025-07-29T18:15:08.095+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@2e6bbcad
2025-07-29T18:15:08.096+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@1593c0ac
2025-07-29T18:15:08.097+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@60511bf5
2025-07-29T18:15:08.097+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@173c5fac
2025-07-29T18:15:08.323+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@1556d953
2025-07-29T18:15:08.325+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:08.326+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"7e1aa125-b832-4626-a343-448b9a2e950b","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:08.330+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@3a912029
2025-07-29T18:15:08.331+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3cf7d1ee
2025-07-29T18:15:08.332+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@1d360d35
2025-07-29T18:15:08.333+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3e89d381
2025-07-29T18:15:08.334+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@daa2c11
2025-07-29T18:15:08.336+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: dataset options: null statement: SELECT `_class`, META(`dataset`).`id` AS __id, `name`, `description`, `teamId`, `accessType`, `authorizedTeamIds`, `tags`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `dataset` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.Dataset" ORDER BY createdDateTime DESC,name ASC LIMIT 12
2025-07-29T18:15:08.337+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] o.s.d.c.core.query.OptionsBuilder        : query options: {"client_context_id":"e3ba4ea7-936f-4e5b-83d5-6dc75449de3c","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:08.341+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: dataset options: null statement: SELECT COUNT("*") AS `count` FROM `dataset` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.Dataset"
2025-07-29T18:15:08.342+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] o.s.d.c.core.query.OptionsBuilder        : query options: {"client_context_id":"0c5b0fce-6ab5-4651-9a53-2f0153aafbb1","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:08.351+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@7a6f11ae
2025-07-29T18:15:08.353+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:08.354+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"7366bbdc-efdd-46b4-9e54-d51ca650ec1e","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:08.359+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@34d27b2
2025-07-29T18:15:08.360+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4348e7f1
2025-07-29T18:15:08.361+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@7467990f
2025-07-29T18:15:08.362+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@7687144c
2025-07-29T18:15:08.362+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@1c1ddd99
2025-07-29T18:15:08.364+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: dataset options: null statement: SELECT `_class`, META(`dataset`).`id` AS __id, `name`, `description`, `teamId`, `accessType`, `authorizedTeamIds`, `tags`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `dataset` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.Dataset" ORDER BY createdDateTime DESC,name ASC LIMIT 12
2025-07-29T18:15:08.364+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] o.s.d.c.core.query.OptionsBuilder        : query options: {"client_context_id":"95fa7a1f-5844-46a0-aad1-49558819e1ef","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:08.368+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: dataset options: null statement: SELECT COUNT("*") AS `count` FROM `dataset` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.Dataset"
2025-07-29T18:15:08.369+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] o.s.d.c.core.query.OptionsBuilder        : query options: {"client_context_id":"c5ecdba8-8914-4766-8934-68528809cceb","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:09.694+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=25c8b4ae-9124-4647-98a3-a922cd3cbe04 scope: AI collection: dataset options: com.couchbase.client.java.kv.GetOptions@471a0723
2025-07-29T18:15:09.696+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: document options: null statement: SELECT `_class`, META(`document`).`id` AS __id, `datasetId`, `fileName`, `fullPath`, `storageType`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `document` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.Document" AND `datasetId` = $1
2025-07-29T18:15:09.696+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["25c8b4ae-9124-4647-98a3-a922cd3cbe04"],"client_context_id":"7dec5c36-bc73-427a-a13e-7f9c67fc1dc2","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:09.710+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=25c8b4ae-9124-4647-98a3-a922cd3cbe04 scope: AI collection: dataset options: com.couchbase.client.java.kv.GetOptions@11e6aa6b
2025-07-29T18:15:09.713+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: document options: null statement: SELECT `_class`, META(`document`).`id` AS __id, `datasetId`, `fileName`, `fullPath`, `storageType`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `document` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.Document" AND `datasetId` = $1
2025-07-29T18:15:09.713+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["25c8b4ae-9124-4647-98a3-a922cd3cbe04"],"client_context_id":"adf2eb76-f063-415b-bab4-802e0f6c95f8","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:09.734+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:09.734+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:09.735+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@114709fc
2025-07-29T18:15:09.735+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@5dff3191
2025-07-29T18:15:09.736+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:09.736+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:09.737+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"b0b5296b-e0fa-4d5e-9b83-1d37da18cd03","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:09.737+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"3c7a234f-1fa5-46a6-bdf3-f529b6143be4","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:09.741+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@c07f18c
2025-07-29T18:15:09.741+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@47af7888
2025-07-29T18:15:09.742+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@54ece614
2025-07-29T18:15:09.742+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@1bb721a4
2025-07-29T18:15:09.743+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@730b0e86
2025-07-29T18:15:09.743+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3f60f8fa
2025-07-29T18:15:09.744+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5a2ae1f2
2025-07-29T18:15:09.744+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@7b89bcd9
2025-07-29T18:15:09.745+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@6912f0aa
2025-07-29T18:15:09.745+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@47def018
2025-07-29T18:15:09.745+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:09.745+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:09.746+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:09.746+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:09.747+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:09.747+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:09.748+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["0b2ccf95-86ad-4d3a-a0d5-028963a7498d"],"client_context_id":"c48819f8-2e78-403d-a90d-1afeec039b8e","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:09.748+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["22dd70f0-5f00-458c-acfd-7919d26f8ee0"],"client_context_id":"ffd2235d-8c4a-4b6a-bb85-1d4532d19c5a","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:09.750+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : Failed to get QA stats for document 0b2ccf95-86ad-4d3a-a0d5-028963a7498d: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50422","lastDispatchedTo":"127.0.0.1:8093","requestId":742,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1333,"totalDispatchMicros":1333,"totalMicros":2073}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50422","lastDispatchedTo":"127.0.0.1:8093","requestId":742,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1333,"totalDispatchMicros":1333,"totalMicros":2073}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:09.751+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : Failed to get QA stats for document 22dd70f0-5f00-458c-acfd-7919d26f8ee0: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50414","lastDispatchedTo":"127.0.0.1:8093","requestId":743,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1505,"totalDispatchMicros":1505,"totalMicros":1853}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50414","lastDispatchedTo":"127.0.0.1:8093","requestId":743,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1505,"totalDispatchMicros":1505,"totalMicros":1853}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:10.059+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:10.059+08:00  INFO 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:10.059+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-9] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:10.060+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@18eed684
2025-07-29T18:15:10.060+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@f50e4eb
2025-07-29T18:15:10.060+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@93f03d8
2025-07-29T18:15:10.062+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:10.062+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:10.062+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:10.062+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"5ea123e1-d419-472f-b275-a2c169c6dc03","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:10.062+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"c3b34ebd-3947-4073-8e52-cdb5b134c039","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:10.063+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"79c0b455-c0d4-4075-b415-5fb108e5fddf","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:10.066+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@50099b77
2025-07-29T18:15:10.066+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@22a21f91
2025-07-29T18:15:10.066+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@7e64fa79
2025-07-29T18:15:10.067+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@1e62c04e
2025-07-29T18:15:10.067+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@52c7c59f
2025-07-29T18:15:10.067+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@345d244d
2025-07-29T18:15:10.067+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@6ce1270e
2025-07-29T18:15:10.068+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@ed1b172
2025-07-29T18:15:10.068+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@458dc0dd
2025-07-29T18:15:10.068+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@2d586e0
2025-07-29T18:15:10.068+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@62e7bff
2025-07-29T18:15:10.068+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@45e6add2
2025-07-29T18:15:10.068+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@1e1b77ee
2025-07-29T18:15:10.069+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@34c2a23c
2025-07-29T18:15:10.069+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@1c083025
2025-07-29T18:15:10.069+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-9] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:10.069+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-9] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:10.069+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:10.070+08:00  INFO 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:10.070+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:10.070+08:00  INFO 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:10.070+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:10.071+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:10.071+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-9] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["2d250eb0-0c42-469a-8b29-628e13ab1820"],"client_context_id":"1862f66b-9121-4e09-acb7-f64bea556ef9","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:10.071+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:10.071+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-5] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["a790aa4e-d9d7-4925-a97f-b811fcbf331b"],"client_context_id":"5d66e329-02d3-4047-8f0e-abae02e03dba","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:10.071+08:00 DEBUG 21129 --- [ecom-assistant] [io-8080-exec-10] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8"],"client_context_id":"fba834b0-79b3-4f6c-9d7e-19a7fdc1e372","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:10.073+08:00 ERROR 21129 --- [ecom-assistant] [io-8080-exec-10] c.e.a.e.controller.QAController          : Failed to get QA stats for document b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50414","lastDispatchedTo":"127.0.0.1:8093","requestId":767,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":835,"totalDispatchMicros":835,"totalMicros":1178}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50414","lastDispatchedTo":"127.0.0.1:8093","requestId":767,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":835,"totalDispatchMicros":835,"totalMicros":1178}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:10.073+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-9] c.e.a.e.controller.QAController          : Failed to get QA stats for document 2d250eb0-0c42-469a-8b29-628e13ab1820: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50422","lastDispatchedTo":"127.0.0.1:8093","requestId":765,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1291,"totalDispatchMicros":1291,"totalMicros":1690}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50422","lastDispatchedTo":"127.0.0.1:8093","requestId":765,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1291,"totalDispatchMicros":1291,"totalMicros":1690}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:10.074+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-5] c.e.a.e.controller.QAController          : Failed to get QA stats for document a790aa4e-d9d7-4925-a97f-b811fcbf331b: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50430","lastDispatchedTo":"127.0.0.1:8093","requestId":766,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1769,"totalDispatchMicros":1769,"totalMicros":2114}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50430","lastDispatchedTo":"127.0.0.1:8093","requestId":766,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1769,"totalDispatchMicros":1769,"totalMicros":2114}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:10.078+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:10.078+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:10.079+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@48b22267
2025-07-29T18:15:10.079+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@56443b8f
2025-07-29T18:15:10.080+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:10.081+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:10.081+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"ea02d7d4-f15c-4bae-8766-742d1a621f51","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:10.081+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"46b56bbf-09b4-4ce6-b15b-b37c2c876500","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:10.084+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@7f43de43
2025-07-29T18:15:10.085+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@4cbb939b
2025-07-29T18:15:10.085+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@6877ed97
2025-07-29T18:15:10.086+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@291d823e
2025-07-29T18:15:10.086+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@4e854285
2025-07-29T18:15:10.086+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@6a03cb1e
2025-07-29T18:15:10.086+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@396a9099
2025-07-29T18:15:10.087+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@337b7d23
2025-07-29T18:15:10.087+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@58bae031
2025-07-29T18:15:10.087+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@234c079c
2025-07-29T18:15:10.088+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:10.088+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:10.088+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:10.088+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:10.089+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:10.089+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:10.089+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-1] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["0b2ccf95-86ad-4d3a-a0d5-028963a7498d"],"client_context_id":"6f9e20b8-7dfe-4ac5-a9f2-7adf1849ced2","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:10.089+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-3] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["22dd70f0-5f00-458c-acfd-7919d26f8ee0"],"client_context_id":"1a08665d-9e8a-4a3d-973a-e92577839ce0","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:10.091+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-1] c.e.a.e.controller.QAController          : Failed to get QA stats for document 0b2ccf95-86ad-4d3a-a0d5-028963a7498d: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50422","lastDispatchedTo":"127.0.0.1:8093","requestId":782,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1090,"totalDispatchMicros":1090,"totalMicros":1462}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50422","lastDispatchedTo":"127.0.0.1:8093","requestId":782,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1090,"totalDispatchMicros":1090,"totalMicros":1462}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:10.091+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-3] c.e.a.e.controller.QAController          : Failed to get QA stats for document 22dd70f0-5f00-458c-acfd-7919d26f8ee0: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50430","lastDispatchedTo":"127.0.0.1:8093","requestId":783,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":986,"totalDispatchMicros":986,"totalMicros":1579}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50430","lastDispatchedTo":"127.0.0.1:8093","requestId":783,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":986,"totalDispatchMicros":986,"totalMicros":1579}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:10.403+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:10.403+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:10.403+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:10.404+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@292179bc
2025-07-29T18:15:10.404+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@1b7b1b63
2025-07-29T18:15:10.404+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@3265594a
2025-07-29T18:15:10.406+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:10.406+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:10.406+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:10.406+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"f5743c81-341a-44bb-8800-71a1ed6999f6","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:10.406+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"008ee839-9e3b-47f2-bcab-3c4e238c355a","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:10.406+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"dba68f11-9ad7-4f06-b1bb-5a058d1b7ecb","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:10.410+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@29b3333
2025-07-29T18:15:10.410+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@dc3199e
2025-07-29T18:15:10.410+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@4a87dece
2025-07-29T18:15:10.410+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@40866a29
2025-07-29T18:15:10.410+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@35fd97e
2025-07-29T18:15:10.411+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@730e482
2025-07-29T18:15:10.411+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@641725a0
2025-07-29T18:15:10.411+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@7d2f7d5c
2025-07-29T18:15:10.411+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@73184888
2025-07-29T18:15:10.412+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@27f48a42
2025-07-29T18:15:10.412+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@6518d4ba
2025-07-29T18:15:10.412+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@51d633ce
2025-07-29T18:15:10.412+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@7c2d2724
2025-07-29T18:15:10.413+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@70022e6e
2025-07-29T18:15:10.413+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@25d3e694
2025-07-29T18:15:10.413+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:10.413+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:10.413+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:10.414+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:10.414+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:10.414+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:10.415+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:10.415+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:10.415+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-4] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8"],"client_context_id":"69a76dc2-a3e5-4939-8dd0-38f7ba88080b","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:10.415+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:10.415+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-2] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["2d250eb0-0c42-469a-8b29-628e13ab1820"],"client_context_id":"294f5ebe-62e9-4610-a9fa-47531bea2b1d","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:10.416+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-6] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["a790aa4e-d9d7-4925-a97f-b811fcbf331b"],"client_context_id":"acc6ee35-8205-43d5-9bf8-d8493bd87ff7","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:10.418+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-2] c.e.a.e.controller.QAController          : Failed to get QA stats for document 2d250eb0-0c42-469a-8b29-628e13ab1820: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50430","lastDispatchedTo":"127.0.0.1:8093","requestId":806,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":926,"totalDispatchMicros":926,"totalMicros":1659}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50430","lastDispatchedTo":"127.0.0.1:8093","requestId":806,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":926,"totalDispatchMicros":926,"totalMicros":1659}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:10.418+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-4] c.e.a.e.controller.QAController          : Failed to get QA stats for document b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50422","lastDispatchedTo":"127.0.0.1:8093","requestId":805,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1356,"totalDispatchMicros":1356,"totalMicros":1973}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50422","lastDispatchedTo":"127.0.0.1:8093","requestId":805,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1356,"totalDispatchMicros":1356,"totalMicros":1973}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:10.418+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-6] c.e.a.e.controller.QAController          : Failed to get QA stats for document a790aa4e-d9d7-4925-a97f-b811fcbf331b: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50414","lastDispatchedTo":"127.0.0.1:8093","requestId":807,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":784,"totalDispatchMicros":784,"totalMicros":1282}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50414","lastDispatchedTo":"127.0.0.1:8093","requestId":807,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":784,"totalDispatchMicros":784,"totalMicros":1282}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAStats(QAController.java:72) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:12.125+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:12.127+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@6b00c02a
2025-07-29T18:15:12.128+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:12.129+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"94d9789a-1fe1-49fd-a5de-79fc08c42763","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:12.133+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@c65172a
2025-07-29T18:15:12.134+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@1faefeba
2025-07-29T18:15:12.135+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@72c27cf5
2025-07-29T18:15:12.135+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@5c99a47c
2025-07-29T18:15:12.136+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@78e12482
2025-07-29T18:15:12.136+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:12.137+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:12.138+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:12.139+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-7] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8"],"client_context_id":"947df50e-52a9-432f-9101-c86cdb02a7d1","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:12.141+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-7] c.e.a.e.controller.QAController          : Failed to retrieve QA pairs for document b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50438","lastDispatchedTo":"127.0.0.1:8093","requestId":816,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1071,"totalDispatchMicros":1071,"totalMicros":1498}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50438","lastDispatchedTo":"127.0.0.1:8093","requestId":816,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1071,"totalDispatchMicros":1071,"totalMicros":1498}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAs(QAController.java:49) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:15:12.401+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : Checking QA verification permission for user: super_admin
2025-07-29T18:15:12.401+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=super_admin scope: AI collection: user options: com.couchbase.client.java.kv.GetOptions@7c81678b
2025-07-29T18:15:12.403+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: team-membership options: null statement: SELECT `_class`, META(`team-membership`).`id` AS __id, `userId`, `teamId`, `teamRoles`, `createdBy`, `createdDateTime`, `lastModifiedBy`, `lastModifiedDateTime` FROM `team-membership` WHERE `_class` = "com.ecom.ai.ecomassistant.db.model.auth.TeamMembership" AND `userId` = $1
2025-07-29T18:15:12.403+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["super_admin"],"client_context_id":"75271c28-85e1-46b3-b1c7-a42943dd0f1e","metrics":false,"scan_consistency":"request_plus"}
2025-07-29T18:15:12.407+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=c79e8f7a-7d4d-47d7-982e-e87b69df5ab5 scope: AI collection: team options: com.couchbase.client.java.kv.GetOptions@2684f11
2025-07-29T18:15:12.408+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-contributor scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@331abb21
2025-07-29T18:15:12.409+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-member scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@b62a8ba
2025-07-29T18:15:12.410+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=dataset-manager scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@7c282b62
2025-07-29T18:15:12.410+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] s.d.c.c.ReactiveFindByIdOperationSupport : findById key=team-admin scope: AI collection: team-role options: com.couchbase.client.java.kv.GetOptions@3cf8e331
2025-07-29T18:15:12.411+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : User super_admin has roles: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫管理者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:知識庫貢獻者, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊成員, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:團隊管理者, system:SUPER_ADMIN] and permissions: [team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:team:view, system:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:view, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:*, team:c79e8f7a-7d4d-47d7-982e-e87b69df5ab5:dataset:file:upload]
2025-07-29T18:15:12.411+08:00  INFO 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : User super_admin has admin role access
2025-07-29T18:15:12.412+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] .c.c.ReactiveFindByQueryOperationSupport : findByQuery scope: AI collection: qa options: null statement: SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC
2025-07-29T18:15:12.413+08:00 DEBUG 21129 --- [ecom-assistant] [nio-8080-exec-8] o.s.d.c.core.query.OptionsBuilder        : query options: {"args":["b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8"],"client_context_id":"9f0a53b8-6152-4294-adef-51c9d5213d54","metrics":false,"scan_consistency":"not_bounded"}
2025-07-29T18:15:12.415+08:00 ERROR 21129 --- [ecom-assistant] [nio-8080-exec-8] c.e.a.e.controller.QAController          : Failed to retrieve QA pairs for document b32c73d0-ffbd-4d76-97a6-2eb1abf38ac8: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50438","lastDispatchedTo":"127.0.0.1:8093","requestId":824,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1126,"totalDispatchMicros":1126,"totalMicros":1833}}

com.couchbase.client.core.error.ParsingFailureException: Parsing of the input failed {"completed":true,"coreId":"0x7225d20200000001","errors":[{"additional":{"line":1,"column":306},"code":3000,"message":"syntax error - line 1, column 306, near '...vectorId` FROM `qa` ', at: FROM (reserved word)","retry":false}],"httpStatus":400,"idempotent":false,"lastDispatchedFrom":"127.0.0.1:50438","lastDispatchedTo":"127.0.0.1:8093","requestId":824,"requestType":"QueryRequest","retried":0,"service":{"bucket":"ECOM","operationId":"null","scope":"AI","statement":"SELECT `_class`, META(`qa`).`id` AS __id, `question`, `answer`, `datasetId`, `datasetName`, `documentName`, `fileName`, `documentId`, `questionIndex`, `contentType`, `createdAt`, `updatedAt`, `verificationStatus`, `verifiedBy`, `verifiedAt`, `verificationNote`, `vectorized`, `tags`, `vectorId` FROM `qa` FROM `ECOM`.`AI`.`qa` qa WHERE qa.documentId = $1 ORDER BY qa.questionIndex ASC","type":"query"},"timeoutMs":75000,"timings":{"dispatchMicros":1126,"totalDispatchMicros":1126,"totalMicros":1833}}
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.errorsToThrowable(QueryChunkResponseParser.java:148) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.lambda$error$10(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.map(Optional.java:260) ~[na:na]
	at com.couchbase.client.core.io.netty.query.QueryChunkResponseParser.error(QueryChunkResponseParser.java:128) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.lambda$maybeCompleteResponseWithFailure$1(ChunkedMessageHandler.java:284) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.util.Optional.orElseGet(Optional.java:364) ~[na:na]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.maybeCompleteResponseWithFailure(ChunkedMessageHandler.java:283) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.io.netty.chunk.ChunkedMessageHandler.channelRead(ChunkedMessageHandler.java:215) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler$DelegatingChannelHandlerContext.fireChannelRead(CombinedChannelDuplexHandler.java:436) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.fireChannelRead(ByteToMessageDecoder.java:346) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.handler.codec.ByteToMessageDecoder.channelRead(ByteToMessageDecoder.java:318) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.CombinedChannelDuplexHandler.channelRead(CombinedChannelDuplexHandler.java:251) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:442) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.fireChannelRead(AbstractChannelHandlerContext.java:412) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline$HeadContext.channelRead(DefaultChannelPipeline.java:1357) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:440) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.AbstractChannelHandlerContext.invokeChannelRead(AbstractChannelHandlerContext.java:420) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.DefaultChannelPipeline.fireChannelRead(DefaultChannelPipeline.java:868) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.AbstractEpollStreamChannel$EpollStreamUnsafe.epollInReady(AbstractEpollStreamChannel.java:799) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.processReady(EpollEventLoop.java:501) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.channel.epoll.EpollEventLoop.run(EpollEventLoop.java:399) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:998) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at com.couchbase.client.core.deps.io.netty.util.concurrent.FastThreadLocalRunnable.run(FastThreadLocalRunnable.java:30) ~[core-io-3.7.9.jar:3.7.9+b5ce2184]
	at java.base/java.lang.Thread.run(Thread.java:1583) ~[na:na]
	Suppressed: java.lang.Exception: #block terminated with an error
		at reactor.core.publisher.BlockingSingleSubscriber.blockingGet(BlockingSingleSubscriber.java:104) ~[reactor-core-3.7.5.jar:3.7.5]
		at reactor.core.publisher.Mono.block(Mono.java:1779) ~[reactor-core-3.7.5.jar:3.7.5]
		at org.springframework.data.couchbase.core.ExecutableFindByQueryOperationSupport$ExecutableFindByQuerySupport.all(ExecutableFindByQueryOperationSupport.java:95) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.lambda$getExecutionToWrap$1(AbstractCouchbaseQuery.java:124) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.CouchbaseQueryExecution$ResultProcessingExecution.execute(CouchbaseQueryExecution.java:84) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQuery.doExecute(AbstractCouchbaseQuery.java:93) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:132) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.couchbase.repository.query.AbstractCouchbaseQueryBase.execute(AbstractCouchbaseQueryBase.java:113) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.doInvoke(RepositoryMethodInvoker.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.RepositoryMethodInvoker.invoke(RepositoryMethodInvoker.java:158) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.doInvoke(QueryExecutorMethodInterceptor.java:170) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.data.repository.core.support.QueryExecutorMethodInterceptor.invoke(QueryExecutorMethodInterceptor.java:149) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.projection.DefaultMethodInvokingMethodInterceptor.invoke(DefaultMethodInvokingMethodInterceptor.java:69) ~[spring-data-commons-3.4.5.jar:3.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.data.couchbase.repository.support.CrudMethodMetadataPostProcessor$CrudMethodMetadataPopulatingMethodInterceptor.invoke(CrudMethodMetadataPostProcessor.java:145) ~[spring-data-couchbase-5.4.5.jar:5.4.5]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:359) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.dao.support.PersistenceExceptionTranslationInterceptor.invoke(PersistenceExceptionTranslationInterceptor.java:138) ~[spring-tx-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184) ~[spring-aop-6.2.6.jar:6.2.6]
		at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:223) ~[spring-aop-6.2.6.jar:6.2.6]
		at jdk.proxy2/jdk.proxy2.$Proxy148.findByDocumentIdOrderByQuestionIndex(Unknown Source) ~[na:na]
		at com.ecom.ai.ecomassistant.db.service.QAPairService.findByDocumentId(QAPairService.java:29) ~[ecom-assistant-db-0.0.1-SNAPSHOT.jar:0.0.1-SNAPSHOT]
		at com.ecom.ai.ecomassistant.controller.QAController.getDocumentQAs(QAController.java:49) ~[classes/:na]
		at java.base/jdk.internal.reflect.DirectMethodHandleAccessor.invoke(DirectMethodHandleAccessor.java:103) ~[na:na]
		at java.base/java.lang.reflect.Method.invoke(Method.java:580) ~[na:na]
		at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:986) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:891) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885) ~[spring-webmvc-6.2.6.jar:6.2.6]
		at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658) ~[tomcat-embed-core-10.1.40.jar:6.0]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:195) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51) ~[tomcat-embed-websocket-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:65) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:109) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:138) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:70) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:463) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.lambda$doFilterInternal$0(AbstractShiroFilter.java:378) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:91) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:84) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:389) ~[shiro-core-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:376) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:156) ~[shiro-web-2.0.4-jakarta.jar:2.0.4]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) ~[spring-web-6.2.6.jar:6.2.6]
		at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116) ~[spring-web-6.2.6.jar:6.2.6]
		at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:164) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:140) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:167) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:90) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:483) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:116) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:93) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:344) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:398) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1740) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1189) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:658) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63) ~[tomcat-embed-core-10.1.40.jar:10.1.40]
		... 1 common frames omitted

2025-07-29T18:16:19.421+08:00  INFO 21129 --- [ecom-assistant] [ionShutdownHook] o.s.b.w.e.tomcat.GracefulShutdown        : Commencing graceful shutdown. Waiting for active requests to complete
2025-07-29T18:16:19.423+08:00  INFO 21129 --- [ecom-assistant] [tomcat-shutdown] o.s.b.w.e.tomcat.GracefulShutdown        : Graceful shutdown complete
2025-07-29T18:16:19.428+08:00  INFO 21129 --- [ecom-assistant] [ionShutdownHook] com.couchbase.transactions.cleanup       : Waiting for 1 regular background threads to exit
2025-07-29T18:16:19.519+08:00  INFO 21129 --- [ecom-assistant] [b-txn-cleanup-4] c.c.transactions.cleanup.regular         : Stopping background cleanup thread for transactions from this client
2025-07-29T18:16:19.519+08:00  INFO 21129 --- [ecom-assistant] [ionShutdownHook] c.couchbase.transactions.cleanup.lost    : Client f7219 stopping lost cleanup process, 0 threads running
2025-07-29T18:16:19.525+08:00  INFO 21129 --- [ecom-assistant] [b-txn-cleanup-4] c.couchbase.transactions.cleanup.lost    : Client f7219 stopped lost cleanup process and removed client from client records
2025-07-29T18:16:19.526+08:00  INFO 21129 --- [ecom-assistant] [b-txn-cleanup-4] com.couchbase.transactions.cleanup       : Background threads have exitted
2025-07-29T18:16:19.544+08:00  INFO 21129 --- [ecom-assistant] [      cb-events] com.couchbase.core                       : [com.couchbase.core][BucketClosedEvent][3199us] Closed bucket "ECOM" {"coreId":"0x7225d20200000001"}
2025-07-29T18:16:19.544+08:00  INFO 21129 --- [ecom-assistant] [      cb-events] com.couchbase.node                       : [com.couchbase.node][NodeDisconnectedEvent][1766us] Node disconnected {"coreId":"0x7225d20200000001","managerPort":"8091","remote":"127.0.0.1"}
2025-07-29T18:16:19.544+08:00  INFO 21129 --- [ecom-assistant] [      cb-events] com.couchbase.core                       : [com.couchbase.core][ShutdownCompletedEvent][14ms] Completed shutdown and closed all open buckets {"coreId":"0x7225d20200000001"}
2025-07-29T18:16:19.587+08:00  INFO 21129 --- [ecom-assistant] [ionShutdownHook] o.s.a.v.CouchbaseSearchVectorStore       : Connection with cluster closed
2025-07-29T18:16:19.588+08:00  INFO 21129 --- [ecom-assistant] [ionShutdownHook] com.couchbase.transactions.cleanup       : Waiting for 0 regular background threads to exit
2025-07-29T18:16:19.588+08:00  INFO 21129 --- [ecom-assistant] [ionShutdownHook] c.couchbase.transactions.cleanup.lost    : Client f7219 stopping lost cleanup process, 0 threads running
2025-07-29T18:16:19.590+08:00  WARN 21129 --- [ecom-assistant] [ionShutdownHook] o.s.b.f.support.DisposableBeanAdapter    : Invocation of close method failed on bean with name 'vectorStore': java.lang.RuntimeException: java.util.concurrent.TimeoutException: Did not observe any item or terminal signal within 10000ms in 'ignoreThen' (and no fallback has been configured)
2025-07-29T18:16:19.597+08:00  INFO 21129 --- [ecom-assistant] [ionShutdownHook] com.couchbase.transactions.cleanup       : Waiting for 0 regular background threads to exit
2025-07-29T18:16:19.598+08:00  INFO 21129 --- [ecom-assistant] [ionShutdownHook] c.couchbase.transactions.cleanup.lost    : Client f7219 stopping lost cleanup process, 0 threads running
2025-07-29T18:16:19.598+08:00  WARN 21129 --- [ecom-assistant] [ionShutdownHook] o.s.b.f.support.DisposableBeanAdapter    : Custom destroy method 'disconnect' on bean with name 'couchbaseCluster' propagated an exception: java.lang.RuntimeException: java.util.concurrent.TimeoutException: Did not observe any item or terminal signal within 10000ms in 'ignoreThen' (and no fallback has been configured)
